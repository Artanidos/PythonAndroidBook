<html>
<head>
<link href="../css/pastie.css" rel="stylesheet" type="text/css"/>
<link href="../css/stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<h1 id="preface">Preface</h1>

<h2 id="copyright">Copyright</h2>

<p><strong>Develop Cross Platform GUI Applications using Python, Qt and PyQt5</strong> <br />
by Olaf Japp <br />
(C) Copyright 2019 Olaf Japp. All rights reserved.</p>

<h2 id="motivation">Motivation</h2>

<p>After coding for over 30 years now, I came from C, Assembler, Clipper, Powerbuilder, Java, C#, Objetive-C, C++ to Python. And guess what... <br />
<strong>I love Python</strong> <br />
It would be easy for me to develop native apps using Java, C++ or Objective-C and I am also able to learn Kotlin, Dart or Swift, but things are much easier when you just use Python. 
I have done a Django tutorial which is a web framework and the ease they have build a model class to be stored in an SQL server has stunned me. I just had to write a model class with a few line of code, then I had to run a scaffolding job which creates corresponding tables on the SQL server and after that I could run the Python interpreter, import my model class, write some properties and save the instance. 
No SQL coding at all. I have been hooked :-) 
Then I learned about generators, comprehension and meta programming and Python got me. </p>

<p>Btw...to be able to write this book I wrote an application called EbookCreator. This app is also using PyQt5, QtWigets and I am using QML to serialize book projects, it is open source and you may have a look at the source code for inspiration. You are able to find the <a href="https://github.com/Artanidos/EbookCreator/">sources</a> on github.</p>

<p>Yesterday I have seen a video with "Uncle" Bob Martin about programming in the future. He says that every 5 years the count of software developers on this planet double. That means that there are at least 50% of all developers that are inexperienced. 
He also said that we as a mature developer are responsible when for example a self driving car is killing other people because of software errors. That heard today I started to teach other developers and I am starting with this book.</p>

<h2 id="who-this-book-is-for">Who This Book Is For</h2>

<p>If you are able to write basic Python code and you are interested in developing apps with user interfaces for multiple platforms in Python this book is right for you. 
This book does not assume that you are familiar with Qt. 
If you want, try out all of the examples in this book it would be a great benefit if you are also working on a Linux machine like me, but MacOS and Windows should also be ok if your are able to search for help in the internet for OS specific differences. </p>

<h2 id="who-this-book-is-not-for">Who This Book Is Not For</h2>

<p>If you are new to Python and programming you should consider reading beginner books for Python and watch tutorials on Youtube before continuing to read this book. 
I am not going into Python specific details in this book. </p>

<h2 id="how-this-book-is-organized">How This Book Is Organized</h2>

<p>Here are the main topics in each part of the book. 
First in <strong><em>Part I</em></strong> you are going to install all necessary software to be able to build applications with PyQt5 and Python.
In <strong><em>Part II</em></strong> you will learn about two different approaches to build apps. 
In <strong><em>Part III</em></strong> you will learn to code apps using QtWigets. <br />
In <strong><em>Part IV</em></strong> you will learn to to create an APK which you can deploy to an Android device.
And in <strong><em>Part V</em></strong> you will learn to create a setup program which you can deploy to a Linux device. </p>

<h2 id="conventions-used-in-this-book">Conventions Used In This Book</h2>

<p>The following typographical conventions are used in this book. </p>

<p><em>Italic</em></p>

<blockquote>
  Used for filenames and paths  
</blockquote>

<pre><code>Constant width
</code></pre>

<blockquote>
  Used for code samples  
</blockquote>

<h2 id="using-code-examples">Using Code Examples</h2>

<p>All <a href="https://github.com/Artanidos/DevAndroidPythonBook/">code examples</a> are available on github .</p>

<h2 id="how-to-contact-me">How To Contact Me</h2>

<p>If you have any questions or comments don't hesitate to send me an email with your questions or comments to the following address: artanidos@gmail.com</p>

<h2 id="acknowledgements">Acknowledgements</h2>

<p>First of all I am very thankful to my body which points me to the right ways in life. I know this sounds a bit weird but after learning to be a mechanic many years ago my back hurts after I have worked way too hard and after a half year being ill I decided to study to build machines and then I have learned to do programming just to solve a mathematical problem. Since that time I decided to be a software developer.
Then 5 years ago my body told me to stop working for profit after I had my second burnout. Now I have got much time to develop open source software, try out new stuff and write books like this. </p>

<p>I am very thankful to Guido van Rossum for inventing Python in 1991.</p>

<p>I am also very thankful to all Pythonistas out there who are creating tutorials and videos on YouTube where one is able to learn Python for free.</p>
<h1 id="part-i-prolog">Part I - Prolog</h1>

<h2 id="installation">Installation</h2>

<p>Here we are going to install all necessary software to be able to write code and test it at least on the desktop. 
To be able to also deploy the app to other devices we will install additional software in the deployment chapter later in this book. </p>

<p>I assume that you already have installed Python3 and Pip. If not you should find all necessary information on the <a href="https://python.org">Python</a> website. We need version 3.7. <br />
I also assume that you able to install software using pip. </p>

<p>First we will install <a href="https://www.riverbankcomputing.com/software/pyqt/intro">PyQt5</a> which comes together with Qt5 to be able to code applications for the desktop. </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> pip install PyQt5
</code></pre></div>

<p>Then we will install <a href="https://code.visualstudio.com/">Visual Studio Code</a> which is free and open source and has many good extensions to develop Python code. 
You can download VSCode <a href="https://code.visualstudio.com/Download">here</a>. I assume that you are able to install VSCode on your own. Otherwise you will find installation instructions on this website. 
You can also use apt if you are on a Linux system. 
Use google search if there are some prerequisites missing. </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> sudo apt install code
</code></pre></div>

<p>In the next chapter we will setup the environment to be able to write our first app. </p>

<h2 id="development-environment-setup">Development Environment Setup</h2>

<p>After installing VSCode you should install some nifty extensions like these.   </p>

<h3 id="python">Python</h3>

<p>Python is a syntax hiliter, debugger and linter. Sometimes it also shows you the correct intellisense. <br />
<img src="../images/python.png" alt="AltText" title="Title" /></p>

<h3 id="coderunner">Coderunner</h3>

<p>With coderunner you are able to start your app with just on click. <br />
<img src="../images/coderunner.png" alt="AltText" title="Title" />
You just have to click the "Play" button. <br />
<img src="../images/runner.png" alt="AltText" title="Title" /></p>

<h3 id="qml">QML</h3>

<p>QML is useful to syntax hilite QML code. <br />
<img src="../images/qml.png" alt="QML" title="QML" /></p>

<h3 id="vscode-settings">VSCode Settings</h3>

<p>You can open the settings file using this menu. <br />
<img src="../images/settings.png" alt="AltText" title="Title" /> <br />
And then click <strong>"{}"</strong> on upper right site of the screen to open the json file. <br />
<img src="../images/json.png" alt="AltText" title="Title" /> <br />
Here are some useful setting which I have entered into the <em>settings.json</em>.  </p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="p">{</span>
<span class="line-number"><span>2</span></span>     <span class="nt">&quot;workbench.colorTheme&quot;</span><span class="p">:</span> <span class="s2">&quot;Visual Studio Dark&quot;</span><span class="p">,</span>
<span class="line-number"><span>3</span></span>     <span class="nt">&quot;code-runner.executorMap&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="line-number"><span>4</span></span>         <span class="nt">&quot;python&quot;</span><span class="p">:</span> <span class="s2">&quot;python3 $workspaceRoot/main.py&quot;</span><span class="p">,</span>
<span class="line-number"><span>5</span></span>     <span class="p">},</span>
<span class="line-number"><span>6</span></span>     <span class="nt">&quot;code-runner.clearPreviousOutput&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="line-number"><span>7</span></span>     <span class="nt">&quot;code-runner.saveAllFilesBeforeRun&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="line-number"><span>8</span></span>     <span class="nt">&quot;git.autofetch&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="line-number"><span>9</span></span> <span class="p">}</span>
</code></pre></div>

<h2 id="first-app">First App</h2>

<p>To test the environment we now create a simple app.  </p>

<p><em>basic.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QWidget</span>
<span class="line-number"><span>3</span></span> 
<span class="line-number"><span>4</span></span> 
<span class="line-number"><span>5</span></span> <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>6</span></span> <span class="n">w</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<span class="line-number"><span>7</span></span> <span class="n">w</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="line-number"><span>8</span></span> <span class="n">w</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Simple&#39;</span><span class="p">)</span>
<span class="line-number"><span>9</span></span> <span class="n">w</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>10</span></span> <span class="n">app</span><span class="o">.</span><span class="k">exec</span><span class="p">()</span>
</code></pre></div>

<p>In this case, because the python file is not named <em>main.py</em> we will run it using the terminal inside of VSCode.  </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> python3 basic.py
</code></pre></div>

<p><img src="../images/simple.png" alt="AltText" title="Title" />  </p>

<p>Here we create an app, instantiate a widget, set the widgets size, set a window title, make the widget visible and execute the main loop. <br />
In this main loop the app is polling for events like mouse and keyboard send them to the window and the window is reacting on them. In this case it will only react on resize, move and the close event when the user clicks the green close button on the upper right corner of the window where the main loop is exited.  </p>

<h2 id="summary">Summary</h2>

<p>After setting up the development environment we now have created our first Qt app at least for the desktop.</p>
<h1 id="part-ii-basics">Part II - Basics</h1>

<h2 id="many-different-approaches">Many Different Approaches</h2>

<p>Because of the fact that Python has been introduced in 1991, meanwhile there are a few user interface approaches to develop Python applications.
There is Tkinter which is a bridge to TK. Tkinter is been delivered with Python. 
There is Kivy which has got a nice approach using a special pythonic language to declare the user interface. 
There is BeeWare which compiles Python to Java-ByteCode which then can be deployed on an Android device. 
There is Enaml Native which act like Pythons answer to React Native and there are a few approaches to bridge to Qt. Qt is pronounced 'Cute'. 
These approaches are PySide, which bridges to Qt4. 
There is PyQt which also bridges to Qt4, PySide2 which bridges to Qt5 and last but not least PyQt5 which we are talking about in this book. 
I am not going to talk about the pros and cons of all these possibilities in this book. Instead I am focusing on solutions. 
To use PyQt5 is a personal decision after working a few years with Qt5. 
Qt5 and PyQt5 are available under an open source license so you might use these frameworks for free as long as you plan to create open source programs. If you are going to create commercial software you have to purchase licenses for both frameworks. 
Even when we are using Qt5 we have got two options to develop applications. 
First option is QtWidgets which has been introduced to create platform independent desktops applications and QtQuick which uses a declarative way to implement user interfaces using QML (Qt Markup Language). 
Because at the moment QtQuick lacks of a tree view and a table view implementation I guess it has been primarily developed to satisfy mobile app development. 
QtQuick has also implemented behaviours and transactions which you normally only see on mobile platforms. 
If you have got design background then the QML approach could be your best choice because you don't really have to write code that much and when you like to write imperative code then QtWidgets might be your way. </p>

<h2 id="hello-world-qtwidgets">Hello World (QtWidgets)</h2>

<p>Now I will show you how a very basic QtWidgets app will look like.   </p>

<p><em>QWidget/Basics/main.py</em>  </p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QLabel</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>
<span class="line-number"><span>4</span></span> 
<span class="line-number"><span>5</span></span> 
<span class="line-number"><span>6</span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="line-number"><span>7</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>8</span></span>         <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>9</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Qt Demo&quot;</span><span class="p">)</span>
<span class="line-number"><span>10</span></span>         <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>
<span class="line-number"><span>11</span></span>         <span class="n">label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<span class="line-number"><span>12</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="line-number"><span>13</span></span> 
<span class="line-number"><span>14</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>15</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>16</span></span>     <span class="n">win</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<span class="line-number"><span>17</span></span>     <span class="n">win</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>18</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="k">exec</span><span class="p">())</span>
</code></pre></div>

<p><img src="../images/hello.png" alt="hello" title="hello" /></p>

<p>The sample is simply self explanatory. We are creating an application object. Instantiate a window. Make the window visible and execute the app main loop. <br />
In the window there is just a label widget which will be set as the central widget. <br />
In bigger projects it would be better to create a python file for each class so that the class MainWindow will become an own file called <em>mainwindow.py</em>.</p>

<h2 id="hello-world-qtquick">Hello World (QtQuick)</h2>

<p>The hello world app for the QtQuick part will be made out of two file. First the main.py where the qml file will be loaded and the main loop will be started and a second file named view.qml where the user interface is been declared.</p>

<p><em>QtQuick/Basics/main.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QGuiApplication</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtQml</span> <span class="kn">import</span> <span class="n">QQmlApplicationEngine</span>
<span class="line-number"><span>4</span></span> 
<span class="line-number"><span>5</span></span> 
<span class="line-number"><span>6</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>7</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QGuiApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>8</span></span>     <span class="n">engine</span> <span class="o">=</span> <span class="n">QQmlApplicationEngine</span><span class="p">(</span><span class="s2">&quot;view.qml&quot;</span><span class="p">)</span>
<span class="line-number"><span>9</span></span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">engine</span><span class="o">.</span><span class="n">rootObjects</span><span class="p">():</span>
<span class="line-number"><span>10</span></span>         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="line-number"><span>11</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="k">exec</span><span class="p">())</span>
</code></pre></div>

<p><em>QtQuick/Basics/view.qml</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.0</span>
<span class="line-number"><span>2</span></span> <span class="kr">import</span> <span class="nx">QtQuick</span><span class="p">.</span><span class="nx">Controls</span> <span class="mf">2.5</span>
<span class="line-number"><span>3</span></span> 
<span class="line-number"><span>4</span></span> <span class="nx">ApplicationWindow</span> <span class="p">{</span>
<span class="line-number"><span>5</span></span>     <span class="k">visible:</span> <span class="kc">true</span>
<span class="line-number"><span>6</span></span> 
<span class="line-number"><span>7</span></span>     <span class="nx">Text</span> <span class="p">{</span>
<span class="line-number"><span>8</span></span>         <span class="k">anchors.horizontalCenter:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">horizontalCenter</span>
<span class="line-number"><span>9</span></span>         <span class="k">anchors.verticalCenter:</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">verticalCenter</span>
<span class="line-number"><span>10</span></span>         <span class="k">text:</span> <span class="s2">&quot;Hello World&quot;</span>
<span class="line-number"><span>11</span></span>     <span class="p">}</span>
<span class="line-number"><span>12</span></span> <span class="p">}</span>
</code></pre></div>

<p>In order to start the app we have to cd into the Basics directory and start it like this:  </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> python3 main.py
</code></pre></div>

<p><img src="../images/qtquick.png" alt="AltText" title="Title" />  </p>

<p>This app is similar to the QtWidgets version except the fact that we use a QGuiApplication instead of a QApplication. And also a QQmlApplicationEngine is responsible to load the user interface.</p>

<h2 id="combining-qwidget-and-qml">Combining QWidget and QML</h2>

<p>A third possibility is to combine both QWidget and QML using the QQuickView inside a QWidget application.  </p>

<p><em>Combo/main.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QWidget</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QUrl</span>
<span class="line-number"><span>4</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtQuick</span> <span class="kn">import</span> <span class="n">QQuickView</span>
<span class="line-number"><span>5</span></span> 
<span class="line-number"><span>6</span></span> 
<span class="line-number"><span>7</span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="line-number"><span>8</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>9</span></span>         <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>10</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Qt Combo Demo&quot;</span><span class="p">)</span>
<span class="line-number"><span>11</span></span>         <span class="n">widget</span><span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<span class="line-number"><span>12</span></span>         <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>13</span></span>         <span class="n">view</span> <span class="o">=</span> <span class="n">QQuickView</span><span class="p">()</span>
<span class="line-number"><span>14</span></span>         <span class="n">container</span> <span class="o">=</span> <span class="n">QWidget</span><span class="o">.</span><span class="n">createWindowContainer</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>15</span></span>         <span class="n">container</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="line-number"><span>16</span></span>         <span class="n">container</span><span class="o">.</span><span class="n">setMaximumSize</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="line-number"><span>17</span></span>         <span class="n">view</span><span class="o">.</span><span class="n">setSource</span><span class="p">(</span><span class="n">QUrl</span><span class="p">(</span><span class="s2">&quot;view.qml&quot;</span><span class="p">))</span>
<span class="line-number"><span>18</span></span>         <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>
<span class="line-number"><span>19</span></span>         <span class="n">label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
<span class="line-number"><span>20</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="line-number"><span>21</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<span class="line-number"><span>22</span></span>         <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="line-number"><span>23</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
<span class="line-number"><span>24</span></span> 
<span class="line-number"><span>25</span></span> 
<span class="line-number"><span>26</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>27</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>28</span></span>     <span class="n">win</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<span class="line-number"><span>29</span></span>     <span class="n">win</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>30</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="k">exec</span><span class="p">())</span>
</code></pre></div>

<p><em>Combo/view.qml</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kr">import</span> <span class="nx">QtQuick</span> <span class="mf">2.1</span>
<span class="line-number"><span>2</span></span> 
<span class="line-number"><span>3</span></span> <span class="nx">Rectangle</span> <span class="p">{</span>
<span class="line-number"><span>4</span></span>     <span class="kd">id: rectangle</span>
<span class="line-number"><span>5</span></span>     <span class="k">color:</span> <span class="s2">&quot;red&quot;</span>
<span class="line-number"><span>6</span></span>     <span class="k">width:</span> <span class="mi">200</span>
<span class="line-number"><span>7</span></span>     <span class="k">height:</span> <span class="mi">200</span>
<span class="line-number"><span>8</span></span> 
<span class="line-number"><span>9</span></span>     <span class="nx">Text</span> <span class="p">{</span>
<span class="line-number"><span>10</span></span>         <span class="kd">id: text</span>
<span class="line-number"><span>11</span></span>         <span class="k">text:</span> <span class="s2">&quot;This is QML code&quot;</span>
<span class="line-number"><span>12</span></span>         <span class="k">font.pointSize:</span> <span class="mi">14</span>
<span class="line-number"><span>13</span></span>         <span class="k">anchors.centerIn:</span> <span class="nx">parent</span>
<span class="line-number"><span>14</span></span>         <span class="nx">PropertyAnimation</span> <span class="p">{</span>
<span class="line-number"><span>15</span></span>             <span class="kd">id: animation</span>
<span class="line-number"><span>16</span></span>             <span class="k">target:</span> <span class="nx">text</span>
<span class="line-number"><span>17</span></span>             <span class="k">property:</span> <span class="s2">&quot;rotation&quot;</span>
<span class="line-number"><span>18</span></span>             <span class="k">from:</span> <span class="mi">0</span><span class="p">;</span> <span class="k">to:</span> <span class="mi">360</span><span class="p">;</span> <span class="k">duration:</span> <span class="mi">5000</span>
<span class="line-number"><span>19</span></span>             <span class="k">loops:</span> <span class="nx">Animation</span><span class="p">.</span><span class="nx">Infinite</span>
<span class="line-number"><span>20</span></span>         <span class="p">}</span>
<span class="line-number"><span>21</span></span>     <span class="p">}</span>
<span class="line-number"><span>22</span></span>     <span class="nx">MouseArea</span> <span class="p">{</span>
<span class="line-number"><span>23</span></span>         <span class="k">anchors.fill:</span> <span class="nx">parent</span>
<span class="line-number"><span>24</span></span>         <span class="k">onClicked:</span> <span class="nx">animation</span><span class="p">.</span><span class="nx">paused</span> <span class="o">?</span> <span class="nx">animation</span><span class="p">.</span><span class="nx">resume</span><span class="p">()</span> <span class="o">:</span> <span class="nx">animation</span><span class="p">.</span><span class="nx">pause</span><span class="p">()</span>
<span class="line-number"><span>25</span></span>     <span class="p">}</span>
<span class="line-number"><span>26</span></span>     <span class="k">Component.onCompleted:</span> <span class="nx">animation</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span>
<span class="line-number"><span>27</span></span> <span class="p">}</span>
</code></pre></div>

<p><img src="../images/combo.png" alt="Combo" title="Combo" />  </p>

<p>Be aware that you should not use many QQuickViews inside a QWidget window because of performance issues.</p>
<h1 id="part-iii-qtwidgets">Part III QtWidgets</h1>

<h2 id="base-widgets-and-layouts">Base Widgets and Layouts</h2>

<p>Now we will use the most used basic widgets in a small desktop application to give you a first overview of widgets and layouts. <br />
For more details on each widget I invite you to search on the internet.
A good starting point is this webpage: <a href="https://doc.qt.io/qt-5/classes.html">https://doc.qt.io/qt-5/classes.html</a> <br />
On this webpage you often see samples which are written in C++, but you might be able to translate them to Python easily. <br />
Here are some examples:  </p>

<div class="codehilite"><pre><span></span><code><span class="n">QPushButton</span> <span class="o">*</span><span class="n">button</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s">&quot;&amp;Download&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
</code></pre></div>

<p>Because C++ is strong typed the variable button is declared here as a pointer to QPushButton.
The "*" indicates that button is a pointer. The new keyword creates a new instance of QPushButton and this is a pointer to the containing window.
In Python we transform this to:</p>

<div class="codehilite"><pre><span></span><code><span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;&amp;Download&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div>

<p>If you see code like this:</p>

<div class="codehilite"><pre><span></span><code><span class="n">findDialog</span><span class="o">-&gt;</span><span class="n">show</span><span class="p">();</span>
</code></pre></div>

<p>This means findDialog is a pointer to a dialog instance and via the "->" operator the show method is called.
We translate this to:</p>

<div class="codehilite"><pre><span></span><code><span class="n">findDialog</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p>Sometimes in C++ objects are declared like this (without the * in front of the variable and the new keyword in front of the class name). Also the operator to call method has changed to "." instead of "->".</p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="n">QFileDialog</span> <span class="nf">dialog</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="line-number"><span>2</span></span> <span class="n">dialog</span><span class="p">.</span><span class="n">setFileMode</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">::</span><span class="n">AnyFile</span><span class="p">);</span>
</code></pre></div>

<p>This means the variable dialog of type QFileDialog has been declared and initialized with "this" (the containing window).
In Python we will code it like this:</p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="n">dialog</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>2</span></span> <span class="n">dialog</span><span class="o">.</span><span class="n">setFileMode</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">AnyFile</span><span class="p">)</span>
</code></pre></div>

<p>In Python we make no difference between objects and pointers. Also notice that instead of the "::" enum operator in Python we just use a dot "." to access a enumeration field.  </p>

<p>But now it's time for an example.  </p>

<p><em>QWidget/BaseWidgets/main.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QGridLayout</span><span class="p">,</span> 
<span class="line-number"><span>3</span></span>                              <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QGroupBox</span><span class="p">,</span> 
<span class="line-number"><span>4</span></span>                              <span class="n">QRadioButton</span><span class="p">,</span> <span class="n">QCheckBox</span><span class="p">,</span> <span class="n">QComboBox</span><span class="p">)</span>
<span class="line-number"><span>5</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>
<span class="line-number"><span>6</span></span> 
<span class="line-number"><span>7</span></span> 
<span class="line-number"><span>8</span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="line-number"><span>9</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>10</span></span>         <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>11</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Qt Demo&quot;</span><span class="p">)</span>
<span class="line-number"><span>12</span></span>         <span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<span class="line-number"><span>13</span></span>         <span class="n">layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
<span class="line-number"><span>14</span></span>         <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>15</span></span>         <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>16</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">name_edit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
<span class="line-number"><span>17</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">name_edit</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Enter your full name here&quot;</span><span class="p">)</span>
<span class="line-number"><span>18</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">name_edit</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="line-number"><span>19</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">email_edit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
<span class="line-number"><span>20</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">email_edit</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Enter a valid email address here&quot;</span><span class="p">)</span>
<span class="line-number"><span>21</span></span>         <span class="n">group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Select category&quot;</span><span class="p">)</span>
<span class="line-number"><span>22</span></span>         <span class="n">group</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>
<span class="line-number"><span>23</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">free</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Free&quot;</span><span class="p">)</span>
<span class="line-number"><span>24</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">premium</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Premium&quot;</span><span class="p">)</span>
<span class="line-number"><span>25</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">enterprise</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Enterprise&quot;</span><span class="p">)</span>
<span class="line-number"><span>26</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">free</span><span class="p">)</span>
<span class="line-number"><span>27</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">premium</span><span class="p">)</span>
<span class="line-number"><span>28</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enterprise</span><span class="p">)</span>
<span class="line-number"><span>29</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">cb</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Send me an invoice&quot;</span><span class="p">)</span>
<span class="line-number"><span>30</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">combo</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
<span class="line-number"><span>31</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;5 GB&quot;</span><span class="p">)</span>
<span class="line-number"><span>32</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;10 GB&quot;</span><span class="p">)</span>
<span class="line-number"><span>33</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;20 GB&quot;</span><span class="p">)</span>
<span class="line-number"><span>34</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;50 GB&quot;</span><span class="p">)</span>
<span class="line-number"><span>35</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;100 GB&quot;</span><span class="p">)</span>
<span class="line-number"><span>36</span></span>         <span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Ok&quot;</span><span class="p">)</span>
<span class="line-number"><span>37</span></span>         <span class="n">cancel_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">)</span>
<span class="line-number"><span>38</span></span>         <span class="n">hbox</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<span class="line-number"><span>39</span></span>         <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">ok_button</span><span class="p">)</span>
<span class="line-number"><span>40</span></span>         <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">cancel_button</span><span class="p">)</span>
<span class="line-number"><span>41</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Name:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="line-number"><span>42</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name_edit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="line-number"><span>43</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Email:&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="line-number"><span>44</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">email_edit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="line-number"><span>45</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Data volume&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="line-number"><span>46</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="line-number"><span>47</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cb</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="line-number"><span>48</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="line-number"><span>49</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="line-number"><span>50</span></span>         <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="line-number"><span>51</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
<span class="line-number"><span>52</span></span> 
<span class="line-number"><span>53</span></span>         <span class="n">ok_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">okClicked</span><span class="p">)</span>
<span class="line-number"><span>54</span></span> 
<span class="line-number"><span>55</span></span>     <span class="k">def</span> <span class="nf">okClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>56</span></span>         <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
<span class="line-number"><span>57</span></span>         <span class="n">email</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">email_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
<span class="line-number"><span>58</span></span>         <span class="n">data_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
<span class="line-number"><span>59</span></span>         <span class="n">send_invoice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb</span><span class="o">.</span><span class="n">checkState</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span>
<span class="line-number"><span>60</span></span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">free</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
<span class="line-number"><span>61</span></span>             <span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;Free&quot;</span>
<span class="line-number"><span>62</span></span>         <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">premium</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
<span class="line-number"><span>63</span></span>             <span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;Premium&quot;</span>
<span class="line-number"><span>64</span></span>         <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">enterprise</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
<span class="line-number"><span>65</span></span>             <span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;Enterprise&quot;</span>
<span class="line-number"><span>66</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>67</span></span>             <span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
<span class="line-number"><span>68</span></span> 
<span class="line-number"><span>69</span></span>         <span class="k">print</span><span class="p">(</span><span class="s2">&quot;name:&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="line-number"><span>70</span></span>         <span class="k">print</span><span class="p">(</span><span class="s2">&quot;email:&quot;</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
<span class="line-number"><span>71</span></span>         <span class="k">print</span><span class="p">(</span><span class="s2">&quot;data:&quot;</span><span class="p">,</span> <span class="n">data_volume</span><span class="p">)</span>
<span class="line-number"><span>72</span></span>         <span class="k">print</span><span class="p">(</span><span class="s2">&quot;invoice:&quot;</span><span class="p">,</span> <span class="n">send_invoice</span><span class="p">)</span>
<span class="line-number"><span>73</span></span>         <span class="k">print</span><span class="p">(</span><span class="s2">&quot;category:&quot;</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span>
<span class="line-number"><span>74</span></span> 
<span class="line-number"><span>75</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>76</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>77</span></span>     <span class="n">win</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<span class="line-number"><span>78</span></span>     <span class="n">win</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>79</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="k">exec</span><span class="p">())</span>
</code></pre></div>

<h3 id="layout">Layout</h3>

<p>In this sample we have got the window and inside this window we use a simple QWidget as central widget for the purpose to set the layout of this widget to QGridView. A QGridView arranges all widgets in a row and column fashion. The column count will be emerged depending on the usage of the grid. If you are for example adding a widget with <code>layout.addWidget(widget, 0, 1)
</code> then a widget at row 0 and column 1 will be added. This leads to a column count of 2. If you also define a row- and column span to this method like <code>layout.addWidget(widget, 0, 1, 1, 4)  
</code> then the the column count will be set to 5. <br />
Inside this QGridLayout we use two other layouts. The QVBoxLayout arranges widgets in a vertical direction and the QHBoxLayout lays out widget horizontally. In the case of the <code>hbox
</code> we are using a stretch object to align the buttons to the right side. <br />
To set the window width we use this little trick:</p>

<pre><code>self.name_edit.setMinimumWidth(200)
</code></pre>

<p>We are just setting the minimum width of the second column to 200 pixel and all other columns will be rendered in the same size. </p>

<h3 id="signals-and-slots">Signals and Slots</h3>

<p>Signals and slots are a Qt specific method to create a publisher/subscriber pattern. In our case the QPushButton fires a signal when the button is clicked and the containing widget can connect this signal to a slot. In this case the method okClicked is the slot which will be called each time the button fires a clicked Signal. The signal will be connected with the following syntax:</p>

<div class="codehilite"><pre><span></span><code><span class="n">ok_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">okClicked</span><span class="p">)</span>
</code></pre></div>

<p>If you see C++ samples they might look like this:</p>

<div class="codehilite"><pre><span></span><code><span class="n">connect</span><span class="p">(</span><span class="n">m_button</span><span class="p">,</span> <span class="n">SIGNAL</span> <span class="p">(</span><span class="n">released</span><span class="p">()),</span> <span class="k">this</span><span class="p">,</span> <span class="n">SLOT</span> <span class="p">(</span><span class="n">handleButton</span><span class="p">()));</span>
</code></pre></div>

<p>And they will be translated like this:</p>

<div class="codehilite"><pre><span></span><code><span class="n">m_button</span><span class="o">.</span><span class="n">released</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handleButton</span><span class="p">)</span>
</code></pre></div>

<h2 id="listview">ListView</h2>

<p>Some widgets like the QListView are working with a data model. Here is an example.</p>

<p><em>QWidget/ListView/main.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QListView</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>
<span class="line-number"><span>4</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QStandardItem</span><span class="p">,</span> <span class="n">QStandardItemModel</span>
<span class="line-number"><span>5</span></span> 
<span class="line-number"><span>6</span></span> 
<span class="line-number"><span>7</span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="line-number"><span>8</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>9</span></span>         <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>10</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Qt Demo&quot;</span><span class="p">)</span>
<span class="line-number"><span>11</span></span>         <span class="nb">list</span> <span class="o">=</span> <span class="n">QListView</span><span class="p">()</span>
<span class="line-number"><span>12</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">QStandardItemModel</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="line-number"><span>13</span></span>         <span class="n">cars</span> <span class="o">=</span> <span class="p">[</span>
<span class="line-number"><span>14</span></span>             <span class="s1">&#39;Jaguar&#39;</span><span class="p">,</span>
<span class="line-number"><span>15</span></span>             <span class="s1">&#39;Porsche&#39;</span><span class="p">,</span>
<span class="line-number"><span>16</span></span>             <span class="s1">&#39;Mercedes&#39;</span><span class="p">,</span>
<span class="line-number"><span>17</span></span>             <span class="s1">&#39;Jeep&#39;</span><span class="p">,</span>
<span class="line-number"><span>18</span></span>             <span class="s1">&#39;Toyota&#39;</span>
<span class="line-number"><span>19</span></span>         <span class="p">]</span>
<span class="line-number"><span>20</span></span> 
<span class="line-number"><span>21</span></span>         <span class="k">for</span> <span class="n">car</span> <span class="ow">in</span> <span class="n">cars</span><span class="p">:</span>
<span class="line-number"><span>22</span></span>             <span class="n">item</span> <span class="o">=</span> <span class="n">QStandardItem</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>
<span class="line-number"><span>23</span></span>             <span class="n">item</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="line-number"><span>24</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">appendRow</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="line-number"><span>25</span></span> 
<span class="line-number"><span>26</span></span>         <span class="nb">list</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
<span class="line-number"><span>27</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="line-number"><span>28</span></span> 
<span class="line-number"><span>29</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">itemChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onItemChanged</span><span class="p">)</span>
<span class="line-number"><span>30</span></span> 
<span class="line-number"><span>31</span></span>     <span class="k">def</span> <span class="nf">onItemChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="line-number"><span>32</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">item</span><span class="o">.</span><span class="n">checkState</span><span class="p">():</span>
<span class="line-number"><span>33</span></span>             <span class="k">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; has been unchecked&quot;</span><span class="p">)</span>
<span class="line-number"><span>34</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>35</span></span>             <span class="k">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; has been checked&quot;</span><span class="p">)</span>
<span class="line-number"><span>36</span></span> 
<span class="line-number"><span>37</span></span> 
<span class="line-number"><span>38</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>39</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>40</span></span>     <span class="n">win</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<span class="line-number"><span>41</span></span>     <span class="n">win</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>42</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</code></pre></div>

<p><img src="../images/listview.png" alt="listview" title="listview" /></p>

<p>In this example we use the QStandardItemModel with QStandardItem's for each list item. Just simple.
In the next chapter we will create our own data model.</p>

<h2 id="treewidget">TreeWidget</h2>

<p>For this tree view example we use our own data model which extends the QAbstractItemModel.</p>

<p><em>QWidget/TreeView/treemodel.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">QAbstractItemModel</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QModelIndex</span>
<span class="line-number"><span>2</span></span> 
<span class="line-number"><span>3</span></span> 
<span class="line-number"><span>4</span></span> <span class="k">class</span> <span class="nc">TreeModel</span><span class="p">(</span><span class="n">QAbstractItemModel</span><span class="p">):</span>
<span class="line-number"><span>5</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_nodes</span><span class="p">):</span>
<span class="line-number"><span>6</span></span>         <span class="n">QAbstractItemModel</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>7</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="line-number"><span>8</span></span>         <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">in_nodes</span><span class="p">:</span>
<span class="line-number"><span>9</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<span class="line-number"><span>10</span></span> 
<span class="line-number"><span>11</span></span>     <span class="k">def</span> <span class="nf">rowCount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_index</span><span class="p">):</span>
<span class="line-number"><span>12</span></span>         <span class="k">if</span> <span class="n">in_index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
<span class="line-number"><span>13</span></span>             <span class="k">return</span> <span class="n">in_index</span><span class="o">.</span><span class="n">internalPointer</span><span class="p">()</span><span class="o">.</span><span class="n">childCount</span><span class="p">()</span>
<span class="line-number"><span>14</span></span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">childCount</span><span class="p">()</span>
<span class="line-number"><span>15</span></span> 
<span class="line-number"><span>16</span></span>     <span class="k">def</span> <span class="nf">addChild</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_node</span><span class="p">,</span> <span class="n">in_parent</span><span class="p">):</span>
<span class="line-number"><span>17</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">in_parent</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">in_parent</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
<span class="line-number"><span>18</span></span>             <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span>
<span class="line-number"><span>19</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>20</span></span>             <span class="n">parent</span> <span class="o">=</span> <span class="n">in_parent</span><span class="o">.</span><span class="n">internalPointer</span><span class="p">()</span>
<span class="line-number"><span>21</span></span>         <span class="n">parent</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">in_node</span><span class="p">)</span>
<span class="line-number"><span>22</span></span> 
<span class="line-number"><span>23</span></span>     <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_row</span><span class="p">,</span> <span class="n">in_column</span><span class="p">,</span> <span class="n">in_parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="line-number"><span>24</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">in_parent</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">in_parent</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
<span class="line-number"><span>25</span></span>             <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span>
<span class="line-number"><span>26</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>27</span></span>             <span class="n">parent</span> <span class="o">=</span> <span class="n">in_parent</span><span class="o">.</span><span class="n">internalPointer</span><span class="p">()</span>
<span class="line-number"><span>28</span></span> 
<span class="line-number"><span>29</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">QAbstractItemModel</span><span class="o">.</span><span class="n">hasIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_row</span><span class="p">,</span> <span class="n">in_column</span><span class="p">,</span> <span class="n">in_parent</span><span class="p">):</span>
<span class="line-number"><span>30</span></span>             <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">()</span>
<span class="line-number"><span>31</span></span> 
<span class="line-number"><span>32</span></span>         <span class="n">child</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="n">in_row</span><span class="p">)</span>
<span class="line-number"><span>33</span></span>         <span class="k">if</span> <span class="n">child</span><span class="p">:</span>
<span class="line-number"><span>34</span></span>             <span class="k">return</span> <span class="n">QAbstractItemModel</span><span class="o">.</span><span class="n">createIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_row</span><span class="p">,</span> <span class="n">in_column</span><span class="p">,</span> <span class="n">child</span><span class="p">)</span>
<span class="line-number"><span>35</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>36</span></span>             <span class="k">return</span> <span class="n">QModelIndex</span><span class="p">()</span>
<span class="line-number"><span>37</span></span> 
<span class="line-number"><span>38</span></span>     <span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_index</span><span class="p">):</span>  
<span class="line-number"><span>39</span></span>         <span class="k">if</span> <span class="n">in_index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>  
<span class="line-number"><span>40</span></span>             <span class="n">p</span> <span class="o">=</span> <span class="n">in_index</span><span class="o">.</span><span class="n">internalPointer</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>  
<span class="line-number"><span>41</span></span>             <span class="k">if</span> <span class="n">p</span><span class="p">:</span>  
<span class="line-number"><span>42</span></span>                 <span class="k">return</span> <span class="n">QAbstractItemModel</span><span class="o">.</span><span class="n">createIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>  
<span class="line-number"><span>43</span></span>         <span class="k">return</span> <span class="n">QModelIndex</span><span class="p">()</span>  
<span class="line-number"><span>44</span></span> 
<span class="line-number"><span>45</span></span>     <span class="k">def</span> <span class="nf">columnCount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_index</span><span class="p">):</span>
<span class="line-number"><span>46</span></span>         <span class="k">if</span> <span class="n">in_index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
<span class="line-number"><span>47</span></span>             <span class="k">return</span> <span class="n">in_index</span><span class="o">.</span><span class="n">internalPointer</span><span class="p">()</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()</span>
<span class="line-number"><span>48</span></span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()</span>
<span class="line-number"><span>49</span></span> 
<span class="line-number"><span>50</span></span>     <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_index</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
<span class="line-number"><span>51</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">in_index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
<span class="line-number"><span>52</span></span>             <span class="k">return</span> <span class="bp">None</span>
<span class="line-number"><span>53</span></span>         <span class="n">node</span> <span class="o">=</span> <span class="n">in_index</span><span class="o">.</span><span class="n">internalPointer</span><span class="p">()</span>
<span class="line-number"><span>54</span></span>         <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span><span class="p">:</span>
<span class="line-number"><span>55</span></span>             <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">in_index</span><span class="o">.</span><span class="n">column</span><span class="p">())</span>
<span class="line-number"><span>56</span></span>         <span class="k">return</span> <span class="bp">None</span>
<span class="line-number"><span>57</span></span> 
<span class="line-number"><span>58</span></span> 
<span class="line-number"><span>59</span></span> <span class="k">class</span> <span class="nc">TreeNode</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="line-number"><span>60</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_data</span><span class="p">):</span>
<span class="line-number"><span>61</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">in_data</span>
<span class="line-number"><span>62</span></span>         <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="line-number"><span>63</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span>
<span class="line-number"><span>64</span></span>         <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">in_data</span><span class="p">,</span> <span class="s1">&#39;__getitem__&#39;</span><span class="p">):</span>
<span class="line-number"><span>65</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">in_data</span><span class="p">]</span>
<span class="line-number"><span>66</span></span> 
<span class="line-number"><span>67</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">_columncount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
<span class="line-number"><span>68</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[]</span>
<span class="line-number"><span>69</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">None</span>
<span class="line-number"><span>70</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">_row</span> <span class="o">=</span> <span class="mi">0</span>
<span class="line-number"><span>71</span></span> 
<span class="line-number"><span>72</span></span>     <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_column</span><span class="p">):</span>
<span class="line-number"><span>73</span></span>         <span class="k">if</span> <span class="n">in_column</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">in_column</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">):</span>
<span class="line-number"><span>74</span></span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">in_column</span><span class="p">]</span>
<span class="line-number"><span>75</span></span> 
<span class="line-number"><span>76</span></span>     <span class="k">def</span> <span class="nf">columnCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>77</span></span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columncount</span>
<span class="line-number"><span>78</span></span> 
<span class="line-number"><span>79</span></span>     <span class="k">def</span> <span class="nf">childCount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>80</span></span>         <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span>
<span class="line-number"><span>81</span></span> 
<span class="line-number"><span>82</span></span>     <span class="k">def</span> <span class="nf">child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_row</span><span class="p">):</span>
<span class="line-number"><span>83</span></span>         <span class="k">if</span> <span class="n">in_row</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">in_row</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">childCount</span><span class="p">():</span>
<span class="line-number"><span>84</span></span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">in_row</span><span class="p">]</span>
<span class="line-number"><span>85</span></span> 
<span class="line-number"><span>86</span></span>     <span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>87</span></span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
<span class="line-number"><span>88</span></span> 
<span class="line-number"><span>89</span></span>     <span class="k">def</span> <span class="nf">row</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>90</span></span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row</span>
<span class="line-number"><span>91</span></span> 
<span class="line-number"><span>92</span></span>     <span class="k">def</span> <span class="nf">addChild</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_child</span><span class="p">):</span>
<span class="line-number"><span>93</span></span>         <span class="n">in_child</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
<span class="line-number"><span>94</span></span>         <span class="n">in_child</span><span class="o">.</span><span class="n">_row</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span>
<span class="line-number"><span>95</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">in_child</span><span class="p">)</span>
<span class="line-number"><span>96</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">_columncount</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">in_child</span><span class="o">.</span><span class="n">columnCount</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columncount</span><span class="p">)</span>
</code></pre></div>

<p>When subclassing QAbstractItemModel, at the very least you must implement index(), parent(), rowCount(), columnCount(), and data(). These functions are used in all read-only models, and form the basis of editable models.</p>

<p><em>QWidget/TreeView/main.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QTreeView</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>
<span class="line-number"><span>4</span></span> <span class="kn">from</span> <span class="nn">treemodel</span> <span class="kn">import</span> <span class="n">TreeModel</span><span class="p">,</span> <span class="n">TreeNode</span>
<span class="line-number"><span>5</span></span> 
<span class="line-number"><span>6</span></span> 
<span class="line-number"><span>7</span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="line-number"><span>8</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>9</span></span>         <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>10</span></span> 
<span class="line-number"><span>11</span></span>         <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
<span class="line-number"><span>12</span></span>         <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TreeNode</span><span class="p">(</span><span class="s2">&quot;Root&quot;</span><span class="p">))</span>
<span class="line-number"><span>13</span></span>         <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">TreeNode</span><span class="p">([</span><span class="s2">&quot;Leaf A&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]))</span>
<span class="line-number"><span>14</span></span>         <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">TreeNode</span><span class="p">([</span><span class="s2">&quot;Leaf B&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]))</span>
<span class="line-number"><span>15</span></span>         <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">child</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">TreeNode</span><span class="p">([</span><span class="s2">&quot;Sub Leaf&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">]))</span>
<span class="line-number"><span>16</span></span> 
<span class="line-number"><span>17</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Qt Demo&quot;</span><span class="p">)</span>
<span class="line-number"><span>18</span></span>         <span class="n">tree</span> <span class="o">=</span> <span class="n">QTreeView</span><span class="p">()</span>
<span class="line-number"><span>19</span></span>         <span class="n">tree</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="n">TreeModel</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>
<span class="line-number"><span>20</span></span>         <span class="n">tree</span><span class="o">.</span><span class="n">setHeaderHidden</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="line-number"><span>21</span></span>         <span class="n">tree</span><span class="o">.</span><span class="n">setColumnWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="line-number"><span>22</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="line-number"><span>23</span></span> 
<span class="line-number"><span>24</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>25</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>26</span></span>     <span class="n">win</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<span class="line-number"><span>27</span></span>     <span class="n">win</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>28</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</code></pre></div>

<p><img src="../images/treeview.png" alt="treeview" title="treeview" /> <br />
This is also a very basic example but it's a good start to see how to use treeviews at all.</p>

<h2 id="dialog">Dialog</h2>

<p>If you prefer to create all your windows and dialogs using Qt-Creator which contains a user interface editor, then you can use the following technique. Open Qt-Creator and edit a dialog in design mode.
<img src="../images/qtcreator.png" alt="qtcreator" title="qtcreator" />  </p>

<p>The created dialog will then be saved in a "*.ui" file an can be used in our code as follows.</p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.uic</span> <span class="kn">import</span> <span class="n">loadUiType</span>
<span class="line-number"><span>4</span></span> 
<span class="line-number"><span>5</span></span> <span class="n">UIClass</span><span class="p">,</span> <span class="n">QtBaseClass</span> <span class="o">=</span> <span class="n">loadUiType</span><span class="p">(</span><span class="s2">&quot;dialog.ui&quot;</span><span class="p">)</span>
<span class="line-number"><span>6</span></span> 
<span class="line-number"><span>7</span></span> <span class="k">class</span> <span class="nc">MyApp</span><span class="p">(</span><span class="n">UIClass</span><span class="p">,</span> <span class="n">QtBaseClass</span><span class="p">):</span>
<span class="line-number"><span>8</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>9</span></span>         <span class="n">UIClass</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>10</span></span>         <span class="n">QtBaseClass</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>11</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>12</span></span> 
<span class="line-number"><span>13</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>14</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>15</span></span>     <span class="n">window</span> <span class="o">=</span> <span class="n">MyApp</span><span class="p">()</span>
<span class="line-number"><span>16</span></span>     <span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>17</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>   
</code></pre></div>

<p><img src="../images/dialog_ui.png" alt="dialog_ui" title="dialog_ui" /></p>

<h2 id="messagedialog">MessageDialog</h2>

<p>Here is a sample to show some possibilities to use a messagebox.  </p>

<p><em>QWidget/MessageDialog/main.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QMessageBox</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>
<span class="line-number"><span>4</span></span> 
<span class="line-number"><span>5</span></span> 
<span class="line-number"><span>6</span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="line-number"><span>7</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>8</span></span>         <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>9</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Qt Demo&quot;</span><span class="p">)</span>
<span class="line-number"><span>10</span></span>         <span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<span class="line-number"><span>11</span></span>         <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>12</span></span>         <span class="n">simple</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Simple&quot;</span><span class="p">)</span>
<span class="line-number"><span>13</span></span>         <span class="n">save</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Save&quot;</span><span class="p">)</span>
<span class="line-number"><span>14</span></span>         <span class="n">details</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Save with details&quot;</span><span class="p">)</span>
<span class="line-number"><span>15</span></span>         <span class="n">warning</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">)</span>
<span class="line-number"><span>16</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">simple</span><span class="p">)</span>
<span class="line-number"><span>17</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">save</span><span class="p">)</span>
<span class="line-number"><span>18</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">details</span><span class="p">)</span>
<span class="line-number"><span>19</span></span>         <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span>
<span class="line-number"><span>20</span></span>         <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="line-number"><span>21</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
<span class="line-number"><span>22</span></span> 
<span class="line-number"><span>23</span></span>         <span class="n">simple</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simple</span><span class="p">)</span>
<span class="line-number"><span>24</span></span>         <span class="n">save</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">)</span>
<span class="line-number"><span>25</span></span>         <span class="n">details</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">details</span><span class="p">)</span>
<span class="line-number"><span>26</span></span>         <span class="n">warning</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">)</span>
<span class="line-number"><span>27</span></span> 
<span class="line-number"><span>28</span></span>     <span class="k">def</span> <span class="nf">simple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>29</span></span>         <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
<span class="line-number"><span>30</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;This is a simple message.&quot;</span><span class="p">)</span>
<span class="line-number"><span>31</span></span>         <span class="n">msg</span><span class="o">.</span><span class="k">exec</span><span class="p">()</span>
<span class="line-number"><span>32</span></span> 
<span class="line-number"><span>33</span></span>     <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>34</span></span>         <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
<span class="line-number"><span>35</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The document has been modified.&quot;</span><span class="p">)</span>
<span class="line-number"><span>36</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="s2">&quot;Do you want to save your changes?&quot;</span><span class="p">)</span>
<span class="line-number"><span>37</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Discard</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
<span class="line-number"><span>38</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setDefaultButton</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span><span class="p">)</span>
<span class="line-number"><span>39</span></span>         <span class="n">ret</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="k">exec</span><span class="p">()</span>
<span class="line-number"><span>40</span></span> 
<span class="line-number"><span>41</span></span>     <span class="k">def</span> <span class="nf">details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>42</span></span>         <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
<span class="line-number"><span>43</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The document has been modified.&quot;</span><span class="p">)</span>
<span class="line-number"><span>44</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="s2">&quot;Do you want to save your changes?&quot;</span><span class="p">)</span>
<span class="line-number"><span>45</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Discard</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
<span class="line-number"><span>46</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setDefaultButton</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span><span class="p">)</span>
<span class="line-number"><span>47</span></span>         <span class="n">msg</span><span class="o">.</span><span class="n">setDetailedText</span><span class="p">(</span><span class="s2">&quot;1: First line</span><span class="se">\n</span><span class="s2">2: Seconds line</span><span class="se">\n</span><span class="s2">3: Third line&quot;</span><span class="p">)</span>
<span class="line-number"><span>48</span></span>         <span class="n">ret</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="k">exec</span><span class="p">()</span>
<span class="line-number"><span>49</span></span> 
<span class="line-number"><span>50</span></span>     <span class="k">def</span> <span class="nf">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>51</span></span>         <span class="n">ret</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;My Application&quot;</span><span class="p">,</span> 
<span class="line-number"><span>52</span></span>             <span class="s2">&quot;The document has been modified.</span><span class="se">\n</span><span class="s2"> Do you want to save your changes?&quot;</span><span class="p">,</span> 
<span class="line-number"><span>53</span></span>             <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Discard</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">,</span> 
<span class="line-number"><span>54</span></span>             <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span><span class="p">)</span>
<span class="line-number"><span>55</span></span> 
<span class="line-number"><span>56</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>57</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>58</span></span>     <span class="n">win</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<span class="line-number"><span>59</span></span>     <span class="n">win</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>60</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="k">exec</span><span class="p">())</span>
</code></pre></div>

<p>Keep in mind that it's not a good practise to use multiple message boxes in a row.  </p>

<p><img src="../images/simple_msg.png" alt="simplemsg" title="simplemsg" /> <br />
<img src="../images/save.png" alt="save" title="save" /> <br />
<img src="../images/save_details.png" alt="savedetails" title="savedetails" /> <br />
<img src="../images/warning.png" alt="warning" title="warning" />  </p>

<p>Like we have got an icon in the warning dialog, we can also the the icon using the <code>setIcon(
</code> method. <br />
We have got four icons to choose from:</p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Question</span><span class="p">)</span>
<span class="line-number"><span>2</span></span> <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
<span class="line-number"><span>3</span></span> <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
<span class="line-number"><span>4</span></span> <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
</code></pre></div>

<h2 id="user-defined-widgets">User Defined Widgets</h2>

<p>Sometimes you are missing a specific widget and if you are not able to download it somewhere, then you have to create it on your own. <br />
In the following example I will introduce a DockWidget, a ScrollArea and of course a user defined widget called Expander. <br />
I remember that I saw an expander in an email client on Windows for the first time. <br />
The usage is very simple. Just click on the rectangle an the content will expand. The content can be a list of menuitems, a text edit, a listbox or whatever.  </p>

<p><em>QWidget/UserDefined/main.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QSizePolicy</span><span class="p">,</span> <span class="n">QListWidget</span><span class="p">,</span> <span class="n">QListWidgetItem</span><span class="p">,</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> 
<span class="line-number"><span>3</span></span>               <span class="n">QTextEdit</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QScrollArea</span><span class="p">,</span> <span class="n">QDockWidget</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">)</span>
<span class="line-number"><span>4</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>
<span class="line-number"><span>5</span></span> <span class="kn">from</span> <span class="nn">expander</span> <span class="kn">import</span> <span class="n">Expander</span>
<span class="line-number"><span>6</span></span> 
<span class="line-number"><span>7</span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="line-number"><span>8</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>9</span></span>         <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>10</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Qt Expander Demo&quot;</span><span class="p">)</span>
<span class="line-number"><span>11</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">)</span>
<span class="line-number"><span>12</span></span> 
<span class="line-number"><span>13</span></span>         <span class="n">edit</span> <span class="o">=</span> <span class="n">QTextEdit</span><span class="p">()</span>
<span class="line-number"><span>14</span></span>         <span class="n">edit</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="s2">&quot;Lorem ipsum dolor...&quot;</span><span class="p">)</span>
<span class="line-number"><span>15</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">Expander</span><span class="p">(</span><span class="s2">&quot;Content&quot;</span><span class="p">,</span> <span class="s2">&quot;parts.svg&quot;</span><span class="p">)</span>
<span class="line-number"><span>16</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="n">Expander</span><span class="p">(</span><span class="s2">&quot;Images&quot;</span><span class="p">,</span> <span class="s2">&quot;images.svg&quot;</span><span class="p">)</span>
<span class="line-number"><span>17</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">Expander</span><span class="p">(</span><span class="s2">&quot;Settings&quot;</span><span class="p">,</span> <span class="s2">&quot;settings.svg&quot;</span><span class="p">)</span>
<span class="line-number"><span>18</span></span>         <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>19</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="line-number"><span>20</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
<span class="line-number"><span>21</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
<span class="line-number"><span>22</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<span class="line-number"><span>23</span></span>         <span class="n">scroll_content</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<span class="line-number"><span>24</span></span>         <span class="n">scroll_content</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>
<span class="line-number"><span>25</span></span>         <span class="n">scroll</span> <span class="o">=</span> <span class="n">QScrollArea</span><span class="p">()</span>
<span class="line-number"><span>26</span></span>         <span class="n">scroll</span><span class="o">.</span><span class="n">setHorizontalScrollBarPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ScrollBarAsNeeded</span><span class="p">)</span>
<span class="line-number"><span>27</span></span>         <span class="n">scroll</span><span class="o">.</span><span class="n">setVerticalScrollBarPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ScrollBarAsNeeded</span><span class="p">)</span>
<span class="line-number"><span>28</span></span>         <span class="n">scroll</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="n">scroll_content</span><span class="p">)</span>
<span class="line-number"><span>29</span></span>         <span class="n">scroll</span><span class="o">.</span><span class="n">setWidgetResizable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="line-number"><span>30</span></span>         <span class="n">scroll</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="line-number"><span>31</span></span>         <span class="n">scroll</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="line-number"><span>32</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">navigationdock</span> <span class="o">=</span> <span class="n">QDockWidget</span><span class="p">(</span><span class="s2">&quot;Navigation&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>33</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">navigationdock</span><span class="o">.</span><span class="n">setAllowedAreas</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftDockWidgetArea</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">RightDockWidgetArea</span><span class="p">)</span>
<span class="line-number"><span>34</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">navigationdock</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="n">scroll</span><span class="p">)</span>
<span class="line-number"><span>35</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">navigationdock</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;Navigation&quot;</span><span class="p">)</span>
<span class="line-number"><span>36</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">addDockWidget</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftDockWidgetArea</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">navigationdock</span><span class="p">)</span>
<span class="line-number"><span>37</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">edit</span><span class="p">)</span>
<span class="line-number"><span>38</span></span> 
<span class="line-number"><span>39</span></span>         <span class="c1"># fill content</span>
<span class="line-number"><span>40</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">content_list</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">()</span>
<span class="line-number"><span>41</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">content_list</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Ignored</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">)</span>
<span class="line-number"><span>42</span></span>         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="line-number"><span>43</span></span>             <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">()</span>
<span class="line-number"><span>44</span></span>             <span class="n">item</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Item &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="line-number"><span>45</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">content_list</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="line-number"><span>46</span></span>         <span class="n">content_box</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>47</span></span>         <span class="n">content_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content_list</span><span class="p">)</span>
<span class="line-number"><span>48</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">content_box</span><span class="p">)</span>
<span class="line-number"><span>49</span></span> 
<span class="line-number"><span>50</span></span> 
<span class="line-number"><span>51</span></span>         <span class="c1"># fill images</span>
<span class="line-number"><span>52</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">images_list</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">()</span>
<span class="line-number"><span>53</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">images_list</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Ignored</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">)</span>
<span class="line-number"><span>54</span></span>         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="line-number"><span>55</span></span>             <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">()</span>
<span class="line-number"><span>56</span></span>             <span class="n">item</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Image &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="line-number"><span>57</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">images_list</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="line-number"><span>58</span></span>         <span class="n">images_box</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>59</span></span>         <span class="n">images_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">images_list</span><span class="p">)</span>
<span class="line-number"><span>60</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">images_box</span><span class="p">)</span>
<span class="line-number"><span>61</span></span> 
<span class="line-number"><span>62</span></span> 
<span class="line-number"><span>63</span></span>         <span class="c1">#fill settings</span>
<span class="line-number"><span>64</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">settings_list</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">()</span>
<span class="line-number"><span>65</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">settings_list</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Ignored</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">)</span>
<span class="line-number"><span>66</span></span>         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="line-number"><span>67</span></span>             <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">()</span>
<span class="line-number"><span>68</span></span>             <span class="n">item</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Setting &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="line-number"><span>69</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">settings_list</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="line-number"><span>70</span></span>         <span class="n">settings_box</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>71</span></span>         <span class="n">settings_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings_list</span><span class="p">)</span>
<span class="line-number"><span>72</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">settings_box</span><span class="p">)</span>
<span class="line-number"><span>73</span></span> 
<span class="line-number"><span>74</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">expanded</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contentExpanded</span><span class="p">)</span>
<span class="line-number"><span>75</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">expanded</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imagesExpanded</span><span class="p">)</span>
<span class="line-number"><span>76</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">expanded</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsExpanded</span><span class="p">)</span>
<span class="line-number"><span>77</span></span> 
<span class="line-number"><span>78</span></span>     <span class="k">def</span> <span class="nf">contentExpanded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="line-number"><span>79</span></span>         <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
<span class="line-number"><span>80</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">setExpanded</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>81</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">setExpanded</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>82</span></span> 
<span class="line-number"><span>83</span></span>     <span class="k">def</span> <span class="nf">imagesExpanded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="line-number"><span>84</span></span>         <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
<span class="line-number"><span>85</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">setExpanded</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>86</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">setExpanded</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>87</span></span> 
<span class="line-number"><span>88</span></span>     <span class="k">def</span> <span class="nf">settingsExpanded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="line-number"><span>89</span></span>         <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
<span class="line-number"><span>90</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">setExpanded</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>91</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">setExpanded</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>92</span></span> 
<span class="line-number"><span>93</span></span> 
<span class="line-number"><span>94</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>95</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>96</span></span>     <span class="n">win</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<span class="line-number"><span>97</span></span>     <span class="n">win</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>98</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="k">exec</span><span class="p">())</span>
</code></pre></div>

<p>The DockWidget can be placed anywhere on the window depending on the AllowedAreas. <br />
In this sample the DockWidget can be placed on the left and on the right side.  </p>

<p>The ScrollArea can contain widgets that are larger than the window itself. If its not possible to display the whole widget, then a scroll bar will be displayed which enables the user to scroll the content. In our sample the scroll bars will only be displayed if there is something to scroll (Qt.ScrollAsNeeded). If the widget fits into the scroll area no scroll bars will be displayed.  </p>

<p><em>QWidget/UserDefined/expander.py</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">os</span>
<span class="line-number"><span>2</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QLabel</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QParallelAnimationGroup</span><span class="p">,</span> <span class="n">QPropertyAnimation</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">pyqtProperty</span><span class="p">,</span> <span class="n">pyqtSignal</span><span class="p">,</span> <span class="n">QDir</span><span class="p">,</span> 
<span class="line-number"><span>4</span></span>                 <span class="n">QFile</span><span class="p">,</span> <span class="n">QIODevice</span><span class="p">)</span>
<span class="line-number"><span>5</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QImage</span><span class="p">,</span> <span class="n">QPalette</span><span class="p">,</span> <span class="n">QPixmap</span><span class="p">,</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QIcon</span>
<span class="line-number"><span>6</span></span> 
<span class="line-number"><span>7</span></span> 
<span class="line-number"><span>8</span></span> <span class="k">class</span> <span class="nc">Expander</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="line-number"><span>9</span></span>     <span class="n">expanded</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
<span class="line-number"><span>10</span></span>     <span class="n">clicked</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">()</span>
<span class="line-number"><span>11</span></span> 
<span class="line-number"><span>12</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">svg</span><span class="p">):</span>
<span class="line-number"><span>13</span></span>         <span class="n">QWidget</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>14</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">svg</span> <span class="o">=</span> <span class="n">svg</span>
<span class="line-number"><span>15</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span> <span class="o">=</span> <span class="bp">False</span>
<span class="line-number"><span>16</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">header</span>
<span class="line-number"><span>17</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">icon</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<span class="line-number"><span>18</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">hyper</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
<span class="line-number"><span>19</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setColors</span><span class="p">()</span>
<span class="line-number"><span>20</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
<span class="line-number"><span>21</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_Hover</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="line-number"><span>22</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setAutoFillBackground</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="line-number"><span>23</span></span> 
<span class="line-number"><span>24</span></span>         <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>25</span></span>         <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
<span class="line-number"><span>26</span></span> 
<span class="line-number"><span>27</span></span>         <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="p">)</span>
<span class="line-number"><span>28</span></span>         <span class="n">hbox</span><span class="o">.</span><span class="n">addSpacing</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="line-number"><span>29</span></span>         <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hyper</span><span class="p">)</span>
<span class="line-number"><span>30</span></span>         <span class="n">hbox</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
<span class="line-number"><span>31</span></span>         <span class="n">hbox</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="line-number"><span>32</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox</span><span class="p">)</span>
<span class="line-number"><span>33</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
<span class="line-number"><span>34</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">base</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
<span class="line-number"><span>35</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="line-number"><span>36</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="line-number"><span>37</span></span>         <span class="n">vbox</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="line-number"><span>38</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>
<span class="line-number"><span>39</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">linkActivated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttonClicked</span><span class="p">)</span>
<span class="line-number"><span>40</span></span> 
<span class="line-number"><span>41</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">anim</span> <span class="o">=</span> <span class="n">QParallelAnimationGroup</span><span class="p">()</span>
<span class="line-number"><span>42</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">height_anim</span> <span class="o">=</span> <span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;maximumHeight&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
<span class="line-number"><span>43</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">color_anim</span> <span class="o">=</span> <span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
<span class="line-number"><span>44</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">height_anim</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="line-number"><span>45</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">color_anim</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="line-number"><span>46</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">addAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height_anim</span><span class="p">)</span>
<span class="line-number"><span>47</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">addAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_anim</span><span class="p">)</span>
<span class="line-number"><span>48</span></span> 
<span class="line-number"><span>49</span></span>     <span class="k">def</span> <span class="nf">setColors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>50</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">label_normal_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">link</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="line-number"><span>51</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">label_hovered_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">highlight</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="line-number"><span>52</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">label_selected_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">highlightedText</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="line-number"><span>53</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">normal_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">base</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="line-number"><span>54</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">selected_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">highlight</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span>
<span class="line-number"><span>55</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">hovered_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span><span class="o">.</span><span class="n">alternateBase</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span>
<span class="line-number"><span>56</span></span> 
<span class="line-number"><span>57</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">normal_icon</span> <span class="o">=</span> <span class="n">QPixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">createIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">svg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_color</span><span class="p">))</span>
<span class="line-number"><span>58</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">hovered_icon</span> <span class="o">=</span> <span class="n">QPixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">createIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">svg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_hovered_color</span><span class="p">))</span>
<span class="line-number"><span>59</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">selected_icon</span> <span class="o">=</span> <span class="n">QPixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">createIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">svg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_hovered_color</span><span class="p">))</span>
<span class="line-number"><span>60</span></span> 
<span class="line-number"><span>61</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normal_icon</span><span class="p">)</span>
<span class="line-number"><span>62</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_color</span>
<span class="line-number"><span>63</span></span> 
<span class="line-number"><span>64</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a style=</span><span class="se">\&quot;</span><span class="s2">color: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_normal_color</span> <span class="o">+</span> 
<span class="line-number"><span>65</span></span>        <span class="s2">&quot; text-decoration: none</span><span class="se">\&quot;</span><span class="s2"> href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">)</span>
<span class="line-number"><span>66</span></span> 
<span class="line-number"><span>67</span></span>     <span class="k">def</span> <span class="nf">createIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">hilite_color</span><span class="p">):</span>
<span class="line-number"><span>68</span></span>         <span class="n">temp</span> <span class="o">=</span> <span class="n">QDir</span><span class="o">.</span><span class="n">tempPath</span><span class="p">()</span>
<span class="line-number"><span>69</span></span>         <span class="nb">file</span> <span class="o">=</span> <span class="n">QFile</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="line-number"><span>70</span></span>         <span class="nb">file</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">QIODevice</span><span class="o">.</span><span class="n">ReadOnly</span> <span class="o">|</span> <span class="n">QIODevice</span><span class="o">.</span><span class="n">Text</span><span class="p">)</span>
<span class="line-number"><span>71</span></span>         <span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">readAll</span><span class="p">(),</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="line-number"><span>72</span></span>         <span class="nb">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="line-number"><span>73</span></span> 
<span class="line-number"><span>74</span></span>         <span class="n">out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">hilite_color</span> <span class="o">+</span> <span class="s2">&quot;.svg&quot;</span><span class="p">)</span>
<span class="line-number"><span>75</span></span>         <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="line-number"><span>76</span></span>             <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#ff00ff&quot;</span><span class="p">,</span> <span class="n">hilite_color</span><span class="p">))</span>
<span class="line-number"><span>77</span></span>         <span class="k">return</span> <span class="n">out</span>
<span class="line-number"><span>78</span></span> 
<span class="line-number"><span>79</span></span>     <span class="k">def</span> <span class="nf">setExpanded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="line-number"><span>80</span></span>         <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">:</span>
<span class="line-number"><span>81</span></span>             <span class="k">return</span>
<span class="line-number"><span>82</span></span> 
<span class="line-number"><span>83</span></span>         <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
<span class="line-number"><span>84</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span> <span class="o">=</span> <span class="bp">True</span>
<span class="line-number"><span>85</span></span>             <span class="n">pal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span>
<span class="line-number"><span>86</span></span>             <span class="n">pal</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Background</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_color</span><span class="p">)</span>
<span class="line-number"><span>87</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">setPalette</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
<span class="line-number"><span>88</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_icon</span><span class="p">)</span>
<span class="line-number"><span>89</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a style=</span><span class="se">\&quot;</span><span class="s2">color: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_selected_color</span> <span class="o">+</span> 
<span class="line-number"><span>90</span></span>            <span class="s2">&quot;; text-decoration: none;</span><span class="se">\&quot;</span><span class="s2"> href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">)</span>
<span class="line-number"><span>91</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>92</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span> <span class="o">=</span> <span class="bp">False</span>
<span class="line-number"><span>93</span></span>             <span class="n">pal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span>
<span class="line-number"><span>94</span></span>             <span class="n">pal</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Background</span><span class="p">,</span> <span class="n">QColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normal_color</span><span class="p">))</span>
<span class="line-number"><span>95</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">setPalette</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
<span class="line-number"><span>96</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normal_icon</span><span class="p">)</span>
<span class="line-number"><span>97</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a style=</span><span class="se">\&quot;</span><span class="s2">color: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_normal_color</span> <span class="o">+</span> 
<span class="line-number"><span>98</span></span>            <span class="s2">&quot;; text-decoration: none;</span><span class="se">\&quot;</span><span class="s2"> href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">)</span>
<span class="line-number"><span>99</span></span> 
<span class="line-number"><span>100</span></span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">:</span>
<span class="line-number"><span>101</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">expandContent</span><span class="p">()</span>
<span class="line-number"><span>102</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>103</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">collapseContent</span><span class="p">()</span>
<span class="line-number"><span>104</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">expanded</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">)</span>
<span class="line-number"><span>105</span></span> 
<span class="line-number"><span>106</span></span>     <span class="k">def</span> <span class="nf">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">):</span>
<span class="line-number"><span>107</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
<span class="line-number"><span>108</span></span> 
<span class="line-number"><span>109</span></span>     <span class="nd">@pyqtProperty</span><span class="p">(</span><span class="s1">&#39;QColor&#39;</span><span class="p">)</span>
<span class="line-number"><span>110</span></span>     <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>111</span></span>         <span class="k">return</span> <span class="n">Qt</span><span class="o">.</span><span class="n">black</span>
<span class="line-number"><span>112</span></span> 
<span class="line-number"><span>113</span></span>     <span class="nd">@color.setter</span>
<span class="line-number"><span>114</span></span>     <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="line-number"><span>115</span></span>         <span class="n">pal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span>
<span class="line-number"><span>116</span></span>         <span class="n">pal</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Background</span><span class="p">,</span> <span class="n">QColor</span><span class="p">(</span><span class="n">color</span><span class="p">))</span>
<span class="line-number"><span>117</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setPalette</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
<span class="line-number"><span>118</span></span> 
<span class="line-number"><span>119</span></span>     <span class="k">def</span> <span class="nf">mouseReleaseEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">me</span><span class="p">):</span>
<span class="line-number"><span>120</span></span>         <span class="k">if</span> <span class="n">me</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">!=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span> <span class="ow">or</span> <span class="n">me</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">:</span>
<span class="line-number"><span>121</span></span>             <span class="k">return</span>
<span class="line-number"><span>122</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setExpanded</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">)</span>
<span class="line-number"><span>123</span></span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">:</span>
<span class="line-number"><span>124</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
<span class="line-number"><span>125</span></span> 
<span class="line-number"><span>126</span></span>     <span class="k">def</span> <span class="nf">expandContent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>127</span></span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">layout</span><span class="p">():</span>
<span class="line-number"><span>128</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">height_anim</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
<span class="line-number"><span>129</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>130</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">height_anim</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="line-number"><span>131</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">height_anim</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="line-number"><span>132</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">color_anim</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normal_color</span><span class="p">)</span>
<span class="line-number"><span>133</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">color_anim</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_color</span><span class="p">)</span>
<span class="line-number"><span>134</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="line-number"><span>135</span></span> 
<span class="line-number"><span>136</span></span>     <span class="k">def</span> <span class="nf">collapseContent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>137</span></span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">layout</span><span class="p">():</span>
<span class="line-number"><span>138</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">height_anim</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
<span class="line-number"><span>139</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>140</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">height_anim</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="line-number"><span>141</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">height_anim</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="line-number"><span>142</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">color_anim</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_color</span><span class="p">)</span>
<span class="line-number"><span>143</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">color_anim</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normal_color</span><span class="p">)</span>
<span class="line-number"><span>144</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="line-number"><span>145</span></span> 
<span class="line-number"><span>146</span></span>     <span class="k">def</span> <span class="nf">buttonClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>147</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setExpanded</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">)</span>
<span class="line-number"><span>148</span></span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">:</span>
<span class="line-number"><span>149</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
<span class="line-number"><span>150</span></span> 
<span class="line-number"><span>151</span></span>     <span class="k">def</span> <span class="nf">enterEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="line-number"><span>152</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">:</span>
<span class="line-number"><span>153</span></span>             <span class="n">pal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span>
<span class="line-number"><span>154</span></span>             <span class="n">pal</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Background</span><span class="p">,</span> <span class="n">QColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hovered_color</span><span class="p">))</span>
<span class="line-number"><span>155</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">setPalette</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
<span class="line-number"><span>156</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hovered_icon</span><span class="p">)</span>
<span class="line-number"><span>157</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a style=</span><span class="se">\&quot;</span><span class="s2">color: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_hovered_color</span> <span class="o">+</span> 
<span class="line-number"><span>158</span></span>            <span class="s2">&quot;; text-decoration: none;</span><span class="se">\&quot;</span><span class="s2"> href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">)</span>
<span class="line-number"><span>159</span></span>         <span class="n">QWidget</span><span class="o">.</span><span class="n">enterEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
<span class="line-number"><span>160</span></span> 
<span class="line-number"><span>161</span></span>     <span class="k">def</span> <span class="nf">leaveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="line-number"><span>162</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expanded</span><span class="p">:</span>
<span class="line-number"><span>163</span></span>             <span class="n">pal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span>
<span class="line-number"><span>164</span></span>             <span class="n">pal</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Background</span><span class="p">,</span> <span class="n">QColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normal_color</span><span class="p">))</span>
<span class="line-number"><span>165</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">setPalette</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
<span class="line-number"><span>166</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">icon</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normal_icon</span><span class="p">)</span>
<span class="line-number"><span>167</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a style=</span><span class="se">\&quot;</span><span class="s2">color: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_normal_color</span> <span class="o">+</span> 
<span class="line-number"><span>168</span></span>            <span class="s2">&quot;; text-decoration: none;</span><span class="se">\&quot;</span><span class="s2"> href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">)</span>
<span class="line-number"><span>169</span></span>         <span class="n">QWidget</span><span class="o">.</span><span class="n">leaveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
</code></pre></div>

<p>For the expander we are using some tricks. <br />
First of all we are using the QLabel as a hyperlink control setting the text to mimic a html anchor.</p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="bp">self</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&lt;a style=</span><span class="se">\&quot;</span><span class="s2">color: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_normal_color</span> <span class="o">+</span> 
<span class="line-number"><span>2</span></span>     <span class="s2">&quot; text-decoration: none</span><span class="se">\&quot;</span><span class="s2"> href=</span><span class="se">\&quot;</span><span class="s2">#</span><span class="se">\&quot;</span><span class="s2">&gt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;&lt;/a&gt;&quot;</span><span class="p">)</span>
</code></pre></div>

<p>When using a QLabel like this we can also use the signal <code>linkActivate
</code> and connect it to a slot.</p>

<div class="codehilite"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">hyper</span><span class="o">.</span><span class="n">linkActivated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttonClicked</span><span class="p">)</span>
</code></pre></div>

<p>The next trick is the use of an animation (QParallelAnimationGroup, QPropertyAnimation) so that the transition when expanding and collapsing the widget looks nice. In our case we are animating the maximumHeight and the background color of the widget. <br />
To be able to animate the color I had to declare it as a property.</p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="nd">@pyqtProperty</span><span class="p">(</span><span class="s1">&#39;QColor&#39;</span><span class="p">)</span>
<span class="line-number"><span>2</span></span> <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>3</span></span>     <span class="k">return</span> <span class="n">Qt</span><span class="o">.</span><span class="n">black</span>
<span class="line-number"><span>4</span></span> 
<span class="line-number"><span>5</span></span> <span class="nd">@color.setter</span>
<span class="line-number"><span>6</span></span> <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="line-number"><span>7</span></span>     <span class="n">pal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">()</span>
<span class="line-number"><span>8</span></span>     <span class="n">pal</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Background</span><span class="p">,</span> <span class="n">QColor</span><span class="p">(</span><span class="n">color</span><span class="p">))</span>
<span class="line-number"><span>9</span></span>     <span class="bp">self</span><span class="o">.</span><span class="n">setPalette</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
</code></pre></div>

<p>Another nice trick is the use of an SVG (scalable vector graphic) image as an icon. <br />
For this trick we are opening an svg image, replacing a specific color with the actual hilite color and then we are creating a pixmap from the svg to use a icon. I have created the svg icon using InkScape. There I have set the color to #ff00ff and in the createIcon method I just replace this color string with the hilite color name. Just to be clear. SVG is a xml based image so we can edit the colors as text.</p>

<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#ff00ff&quot;</span><span class="p">,</span> <span class="n">hilite_color</span><span class="p">)</span>
</code></pre></div>

<h2 id="markowneditor">MarkownEditor</h2>

<p>At the end of this chapter we will create a complex application to fill the gaps with the missing widgets like Menu, MenuItem, StatusBar, Action, Splitter, FileDialog, Settings and WebEngineView.</p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">import</span> <span class="nn">os</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QSplitter</span><span class="p">,</span> <span class="n">QTextEdit</span><span class="p">,</span> <span class="n">QAction</span><span class="p">,</span> 
<span class="line-number"><span>4</span></span>                              <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QDialog</span><span class="p">,</span> <span class="n">QStyleFactory</span><span class="p">)</span>
<span class="line-number"><span>5</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QCoreApplication</span><span class="p">,</span> <span class="n">QSettings</span><span class="p">,</span> <span class="n">QByteArray</span><span class="p">,</span> <span class="n">QUrl</span>
<span class="line-number"><span>6</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QKeySequence</span>
<span class="line-number"><span>7</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtWebEngineWidgets</span> <span class="kn">import</span> <span class="n">QWebEngineView</span>
<span class="line-number"><span>8</span></span> <span class="kn">import</span> <span class="nn">markdown2</span>
<span class="line-number"><span>9</span></span> 
<span class="line-number"><span>10</span></span> 
<span class="line-number"><span>11</span></span> <span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="line-number"><span>12</span></span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>13</span></span>         <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>14</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">cur_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="line-number"><span>15</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span> <span class="o">=</span> <span class="n">QSplitter</span><span class="p">()</span>
<span class="line-number"><span>16</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span> <span class="o">=</span> <span class="n">QTextEdit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="line-number"><span>17</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">preview</span> <span class="o">=</span> <span class="n">QWebEngineView</span><span class="p">()</span>
<span class="line-number"><span>18</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">preview</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="line-number"><span>19</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Markdown [*]&quot;</span><span class="p">)</span>
<span class="line-number"><span>20</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="p">)</span>
<span class="line-number"><span>21</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preview</span><span class="p">)</span>
<span class="line-number"><span>22</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="p">)</span>
<span class="line-number"><span>23</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">createMenus</span><span class="p">()</span>
<span class="line-number"><span>24</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">createStatusBar</span><span class="p">()</span>
<span class="line-number"><span>25</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">readSettings</span><span class="p">()</span>
<span class="line-number"><span>26</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">contentsChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">documentWasModified</span><span class="p">)</span>
<span class="line-number"><span>27</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textChanged</span><span class="p">)</span>
<span class="line-number"><span>28</span></span> 
<span class="line-number"><span>29</span></span>     <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="line-number"><span>30</span></span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maybeSave</span><span class="p">():</span>
<span class="line-number"><span>31</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">writeSettings</span><span class="p">()</span>
<span class="line-number"><span>32</span></span>             <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
<span class="line-number"><span>33</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>34</span></span>             <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
<span class="line-number"><span>35</span></span> 
<span class="line-number"><span>36</span></span>     <span class="k">def</span> <span class="nf">documentWasModified</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>37</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowModified</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">isModified</span><span class="p">())</span>
<span class="line-number"><span>38</span></span> 
<span class="line-number"><span>39</span></span>     <span class="k">def</span> <span class="nf">createMenus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>40</span></span>         <span class="n">new_icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="s2">&quot;./assets/new.png&quot;</span><span class="p">)</span>
<span class="line-number"><span>41</span></span>         <span class="n">open_icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="s2">&quot;./assets/open.png&quot;</span><span class="p">)</span>
<span class="line-number"><span>42</span></span>         <span class="n">save_icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="s2">&quot;./assets/save.png&quot;</span><span class="p">)</span>
<span class="line-number"><span>43</span></span>         <span class="n">save_as_icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="s2">&quot;./assets/save_as.png&quot;</span><span class="p">)</span>
<span class="line-number"><span>44</span></span>         <span class="n">exit_icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="s2">&quot;./assets/exit.png&quot;</span><span class="p">)</span>
<span class="line-number"><span>45</span></span> 
<span class="line-number"><span>46</span></span>         <span class="n">new_act</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">new_icon</span><span class="p">,</span> <span class="s2">&quot;&amp;New&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>47</span></span>         <span class="n">new_act</span><span class="o">.</span><span class="n">setShortcuts</span><span class="p">(</span><span class="n">QKeySequence</span><span class="o">.</span><span class="n">New</span><span class="p">)</span>
<span class="line-number"><span>48</span></span>         <span class="n">new_act</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s2">&quot;Create a new file&quot;</span><span class="p">)</span>
<span class="line-number"><span>49</span></span>         <span class="n">new_act</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newFile</span><span class="p">)</span>
<span class="line-number"><span>50</span></span> 
<span class="line-number"><span>51</span></span>         <span class="n">open_act</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">open_icon</span><span class="p">,</span> <span class="s2">&quot;&amp;Open&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>52</span></span>         <span class="n">open_act</span><span class="o">.</span><span class="n">setShortcuts</span><span class="p">(</span><span class="n">QKeySequence</span><span class="o">.</span><span class="n">Open</span><span class="p">)</span>
<span class="line-number"><span>53</span></span>         <span class="n">open_act</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s2">&quot;Open an existing file&quot;</span><span class="p">)</span>
<span class="line-number"><span>54</span></span>         <span class="n">open_act</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">)</span>
<span class="line-number"><span>55</span></span> 
<span class="line-number"><span>56</span></span>         <span class="n">save_act</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">save_icon</span><span class="p">,</span> <span class="s2">&quot;&amp;Save&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>57</span></span>         <span class="n">save_act</span><span class="o">.</span><span class="n">setShortcuts</span><span class="p">(</span><span class="n">QKeySequence</span><span class="o">.</span><span class="n">Save</span><span class="p">)</span>
<span class="line-number"><span>58</span></span>         <span class="n">save_act</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s2">&quot;Save the document to disk&quot;</span><span class="p">)</span>
<span class="line-number"><span>59</span></span>         <span class="n">save_act</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">)</span>
<span class="line-number"><span>60</span></span> 
<span class="line-number"><span>61</span></span>         <span class="n">save_as_act</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">save_as_icon</span><span class="p">,</span> <span class="s2">&quot;Save &amp;As...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>62</span></span>         <span class="n">save_as_act</span><span class="o">.</span><span class="n">setShortcuts</span><span class="p">(</span><span class="n">QKeySequence</span><span class="o">.</span><span class="n">SaveAs</span><span class="p">)</span>
<span class="line-number"><span>63</span></span>         <span class="n">save_as_act</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s2">&quot;Save the document under a new name&quot;</span><span class="p">)</span>
<span class="line-number"><span>64</span></span>         <span class="n">save_as_act</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveAs</span><span class="p">)</span>
<span class="line-number"><span>65</span></span> 
<span class="line-number"><span>66</span></span>         <span class="n">exit_act</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">exit_icon</span><span class="p">,</span> <span class="s2">&quot;E&amp;xit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>67</span></span>         <span class="n">exit_act</span><span class="o">.</span><span class="n">setShortcuts</span><span class="p">(</span><span class="n">QKeySequence</span><span class="o">.</span><span class="n">Quit</span><span class="p">)</span>
<span class="line-number"><span>68</span></span>         <span class="n">exit_act</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s2">&quot;Exit the application&quot;</span><span class="p">)</span>
<span class="line-number"><span>69</span></span>         <span class="n">exit_act</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
<span class="line-number"><span>70</span></span> 
<span class="line-number"><span>71</span></span>         <span class="n">about_act</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;&amp;About&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>72</span></span>         <span class="n">about_act</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">about</span><span class="p">)</span>
<span class="line-number"><span>73</span></span>         <span class="n">about_act</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s2">&quot;Show the application&#39;s About box&quot;</span><span class="p">)</span>
<span class="line-number"><span>74</span></span> 
<span class="line-number"><span>75</span></span>         <span class="n">file_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;&amp;File&quot;</span><span class="p">)</span>
<span class="line-number"><span>76</span></span>         <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">new_act</span><span class="p">)</span>
<span class="line-number"><span>77</span></span>         <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">open_act</span><span class="p">)</span>
<span class="line-number"><span>78</span></span>         <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">save_act</span><span class="p">)</span>
<span class="line-number"><span>79</span></span>         <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">save_as_act</span><span class="p">)</span>
<span class="line-number"><span>80</span></span>         <span class="n">file_menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
<span class="line-number"><span>81</span></span>         <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">exit_act</span><span class="p">)</span>
<span class="line-number"><span>82</span></span> 
<span class="line-number"><span>83</span></span>         <span class="n">help_menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;&amp;Help&quot;</span><span class="p">)</span>
<span class="line-number"><span>84</span></span>         <span class="n">help_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">about_act</span><span class="p">)</span>
<span class="line-number"><span>85</span></span> 
<span class="line-number"><span>86</span></span>         <span class="n">file_tool_bar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addToolBar</span><span class="p">(</span><span class="s2">&quot;File&quot;</span><span class="p">)</span>
<span class="line-number"><span>87</span></span>         <span class="n">file_tool_bar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">new_act</span><span class="p">)</span>
<span class="line-number"><span>88</span></span>         <span class="n">file_tool_bar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">open_act</span><span class="p">)</span>
<span class="line-number"><span>89</span></span>         <span class="n">file_tool_bar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">save_act</span><span class="p">)</span>
<span class="line-number"><span>90</span></span> 
<span class="line-number"><span>91</span></span>     <span class="k">def</span> <span class="nf">createStatusBar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>92</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Ready&quot;</span><span class="p">)</span>
<span class="line-number"><span>93</span></span> 
<span class="line-number"><span>94</span></span>     <span class="k">def</span> <span class="nf">about</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>95</span></span>         <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;About Markdown&quot;</span><span class="p">,</span>
<span class="line-number"><span>96</span></span>             <span class="s2">&quot;This app demonstrates how to &quot;</span>
<span class="line-number"><span>97</span></span>                <span class="s2">&quot;write modern GUI applications using Qt, with a menu bar, &quot;</span>
<span class="line-number"><span>98</span></span>                <span class="s2">&quot;toolbars, and a status bar.&quot;</span><span class="p">)</span>
<span class="line-number"><span>99</span></span> 
<span class="line-number"><span>100</span></span>     <span class="k">def</span> <span class="nf">newFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>101</span></span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maybeSave</span><span class="p">():</span>
<span class="line-number"><span>102</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="line-number"><span>103</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCurrentFile</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="line-number"><span>104</span></span> 
<span class="line-number"><span>105</span></span>     <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>106</span></span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maybeSave</span><span class="p">():</span>
<span class="line-number"><span>107</span></span>             <span class="n">fileName</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="line-number"><span>108</span></span>         <span class="k">if</span> <span class="n">fileName</span><span class="p">:</span>
<span class="line-number"><span>109</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">loadFile</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
<span class="line-number"><span>110</span></span> 
<span class="line-number"><span>111</span></span>     <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>112</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_file</span><span class="p">:</span>
<span class="line-number"><span>113</span></span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveAs</span><span class="p">()</span>
<span class="line-number"><span>114</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>115</span></span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_file</span><span class="p">)</span>
<span class="line-number"><span>116</span></span> 
<span class="line-number"><span>117</span></span>     <span class="k">def</span> <span class="nf">saveAs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>118</span></span>         <span class="n">dialog</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>119</span></span>         <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowModality</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowModal</span><span class="p">)</span>
<span class="line-number"><span>120</span></span>         <span class="n">dialog</span><span class="o">.</span><span class="n">setAcceptMode</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">AcceptSave</span><span class="p">)</span>
<span class="line-number"><span>121</span></span>         <span class="k">if</span> <span class="n">dialog</span><span class="o">.</span><span class="k">exec</span><span class="p">()</span> <span class="o">!=</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
<span class="line-number"><span>122</span></span>             <span class="k">return</span> <span class="bp">False</span>
<span class="line-number"><span>123</span></span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveFile</span><span class="p">(</span><span class="n">dialog</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="line-number"><span>124</span></span> 
<span class="line-number"><span>125</span></span>     <span class="k">def</span> <span class="nf">maybeSave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>126</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">isModified</span><span class="p">():</span>
<span class="line-number"><span>127</span></span>             <span class="k">return</span> <span class="bp">True</span>
<span class="line-number"><span>128</span></span>         <span class="n">ret</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Qt Demo&quot;</span><span class="p">,</span>
<span class="line-number"><span>129</span></span>                                 <span class="s2">&quot;The document has been modified.</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="line-number"><span>130</span></span>                                 <span class="s2">&quot;Do you want to save your changes?&quot;</span><span class="p">,</span>
<span class="line-number"><span>131</span></span>                                 <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Discard</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span>
<span class="line-number"><span>132</span></span>         <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span><span class="p">:</span>
<span class="line-number"><span>133</span></span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="line-number"><span>134</span></span>         <span class="k">elif</span> <span class="n">ret</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">:</span>
<span class="line-number"><span>135</span></span>             <span class="k">return</span> <span class="bp">False</span>
<span class="line-number"><span>136</span></span>         <span class="k">return</span> <span class="bp">True</span>
<span class="line-number"><span>137</span></span> 
<span class="line-number"><span>138</span></span>     <span class="k">def</span> <span class="nf">loadFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="p">):</span>
<span class="line-number"><span>139</span></span>         <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="line-number"><span>140</span></span>             <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="line-number"><span>141</span></span> 
<span class="line-number"><span>142</span></span>         <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
<span class="line-number"><span>143</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCurrentFile</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
<span class="line-number"><span>144</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="line-number"><span>145</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">setModified</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>146</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowModified</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>147</span></span>         <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>        
<span class="line-number"><span>148</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;File loaded&quot;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="line-number"><span>149</span></span> 
<span class="line-number"><span>150</span></span>     <span class="k">def</span> <span class="nf">saveFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="p">):</span>
<span class="line-number"><span>151</span></span>         <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
<span class="line-number"><span>152</span></span>         <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="line-number"><span>153</span></span>             <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>
<span class="line-number"><span>154</span></span>         <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
<span class="line-number"><span>155</span></span> 
<span class="line-number"><span>156</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setCurrentFile</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
<span class="line-number"><span>157</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">setModified</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>158</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowModified</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="line-number"><span>159</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;File saved&quot;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="line-number"><span>160</span></span> 
<span class="line-number"><span>161</span></span>     <span class="k">def</span> <span class="nf">setCurrentFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="p">):</span>
<span class="line-number"><span>162</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">cur_file</span> <span class="o">=</span> <span class="n">fileName</span>
<span class="line-number"><span>163</span></span>         <span class="n">shown_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_file</span>
<span class="line-number"><span>164</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur_file</span><span class="p">:</span>
<span class="line-number"><span>165</span></span>             <span class="n">shown_name</span> <span class="o">=</span> <span class="s2">&quot;untitled.txt&quot;</span>
<span class="line-number"><span>166</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFilePath</span><span class="p">(</span><span class="n">shown_name</span><span class="p">)</span>
<span class="line-number"><span>167</span></span> 
<span class="line-number"><span>168</span></span>     <span class="k">def</span> <span class="nf">writeSettings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>169</span></span>         <span class="n">settings</span> <span class="o">=</span> <span class="n">QSettings</span><span class="p">(</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">organizationName</span><span class="p">(),</span> <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">applicationName</span><span class="p">())</span>
<span class="line-number"><span>170</span></span>         <span class="n">settings</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveGeometry</span><span class="p">())</span>
<span class="line-number"><span>171</span></span> 
<span class="line-number"><span>172</span></span>     <span class="k">def</span> <span class="nf">readSettings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>173</span></span>         <span class="n">settings</span> <span class="o">=</span> <span class="n">QSettings</span><span class="p">(</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">organizationName</span><span class="p">(),</span> <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">applicationName</span><span class="p">());</span>
<span class="line-number"><span>174</span></span>         <span class="n">geometry</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">QByteArray</span><span class="p">())</span>
<span class="line-number"><span>175</span></span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">geometry</span><span class="p">:</span>
<span class="line-number"><span>176</span></span>             <span class="n">availableGeometry</span> <span class="o">=</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">desktop</span><span class="p">()</span><span class="o">.</span><span class="n">availableGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="line-number"><span>177</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">availableGeometry</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">availableGeometry</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="line-number"><span>178</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">((</span><span class="n">availableGeometry</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">())</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
<span class="line-number"><span>179</span></span>                 <span class="p">(</span><span class="n">availableGeometry</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">())</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="line-number"><span>180</span></span>         <span class="k">else</span><span class="p">:</span>
<span class="line-number"><span>181</span></span>             <span class="bp">self</span><span class="o">.</span><span class="n">restoreGeometry</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>
<span class="line-number"><span>182</span></span> 
<span class="line-number"><span>183</span></span>     <span class="k">def</span> <span class="nf">textChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="line-number"><span>184</span></span>         <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="line-number"><span>185</span></span>         <span class="n">html</span> <span class="o">=</span> <span class="s2">&quot;&lt;html&gt;&lt;head&gt;&lt;link href=</span><span class="se">\&quot;</span><span class="s2">assets/pastie.css</span><span class="se">\&quot;</span><span class="s2"> rel=</span><span class="se">\&quot;</span><span class="s2">stylesheet</span><span class="se">\&quot;</span><span class="s2"> type=</span><span class="se">\&quot;</span><span class="s2">text/css</span><span class="se">\&quot;</span><span class="s2">/&gt;&lt;/head&gt;&lt;body&gt;&quot;</span>
<span class="line-number"><span>186</span></span>         <span class="n">html</span> <span class="o">+=</span> <span class="n">markdown2</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_edit</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">(),</span> <span class="o">...</span><span class="p">,</span> <span class="n">extras</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fenced-code-blocks&quot;</span><span class="p">])</span>
<span class="line-number"><span>187</span></span>         <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>
<span class="line-number"><span>188</span></span>         <span class="bp">self</span><span class="o">.</span><span class="n">preview</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">baseUrl</span> <span class="o">=</span> <span class="n">QUrl</span><span class="p">(</span><span class="s2">&quot;file://&quot;</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="p">))</span>
<span class="line-number"><span>189</span></span> 
<span class="line-number"><span>190</span></span> 
<span class="line-number"><span>191</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>192</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>193</span></span>     <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">setOrganizationName</span><span class="p">(</span><span class="s2">&quot;Book&quot;</span><span class="p">)</span>
<span class="line-number"><span>194</span></span>     <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">setApplicationName</span><span class="p">(</span><span class="s2">&quot;MarkdownEditor&quot;</span><span class="p">)</span>
<span class="line-number"><span>195</span></span>     <span class="n">win</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
<span class="line-number"><span>196</span></span>     <span class="n">win</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="line-number"><span>197</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</code></pre></div>

<p><img src="../images/markdown.png" alt="markdown" title="markdown" /> <br />
The WebEngineView is a full featured html browser widget and is used here in this sample to render the html which will be generated from the markdown source. <br />
The module markdown2 is used to transform the markdown into valid xhtml.  You can download it using pip.  </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> pip install markdown2 
</code></pre></div>

<p>The writeSetting method saves the geometry (position and size of the window) and the readSettings restores these settings.  </p>

<p>The textChanged method will be triggered every time the user enters text into the text edit. In the EbookCreator I had to change this behaviour into a thread call for performance reasons.  </p>

<p>The actions like new<em>act, open</em>act and save_act are used twice here. First we use these actions in the pull down menu and also in the toolbar.  </p>

<p>When you define a menu action then the shortcut letter is marked with the "&amp;". Like the letter "S" in the "&amp;Save" action. Be aware not to use one single letter twice in the same menu.  </p>

<p>The QTextEdit widget can be used to edit plain text and also rich text. Therefore we use <code>self.text_edit.setPlainText(text)
</code> to set the content.  </p>

<p>In this sample the statusBar is used to display messages like <code>self.statusBar().showMessage("File loaded", 2000)
</code> and also to display infos for some menuitems <code>exit_act.setStatusTip("Exit the application")
</code></p>

<p>The above editor was the base for one of my projects called EbookCreator. I have developed the EbookCreator just to be able to write this book. The EbookCreator is also written using Python and PyQt5 and is therefore a good source for you to learn from. The source code is available <a href="https://github.com/Artanidos/EbookCreator">here</a>.  </p>
<h1 id="deploying-to-android">Deploying to Android</h1>

<p>Now we are going to build an APK (<strong>A</strong>ndroid <strong>P</strong>ac<strong>k</strong>age).
Therefore we first have to install a few other components. </p>

<h2 id="install-pyqtdeploy-24">Install pyqtdeploy 2.4</h2>

<p>pyqtdeploy is a tool made by the same company who also created PyQt5. <br />
You can install pyqtdeploy via pip.  </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> pip3 install pyqtdeploy
</code></pre></div>

<h2 id="install-java-jdk-8">Install Java JDK 8</h2>

<p>You should be able to find all you need to install Java JDK 8 here: <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/install/install_overview.html">https://docs.oracle.com/javase/8/docs/technotes/guides/install/install_overview.html</a></p>

<p>Just to mention I had problem to build the package with Java JDK 10 installed. </p>

<h2 id="install-android-sdk">Install Android SDK</h2>

<p>To install the Android SDK go to <a href="https://developer.android.com/studio">https://developer.android.com/studio</a> scroll down to <em>Command line tools only</em> and download the file for your platform. <br />
Then unzip the file somewhere on your computer. 
After unzipping go to the Sdk/tools/bin directory and run the sdkmanager to install all necessary tools:</p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> ./sdkmanager <span class="s2">&quot;platform-tools&quot;</span> <span class="s2">&quot;platforms;android-28&quot;</span>
</code></pre></div>

<h2 id="install-android-ndk">Install Android NDK</h2>

<p>To install the Android NDK go to <a href="https://developer.android.com/ndk/downloads">https://developer.android.com/ndk/downloads</a> scroll down to <em>Older Versions</em>, click the link <em>NDK Archives</em>, agree to the terms and download <em>Android NDK, Revision 19c</em> for your platform (Unfortuneatly version 20 is not working for us yet). <br />
After downloading unzip all the file into the SDK directory as <em>ndk-bundle</em>.
Your Android directory should look like the following: <br />
<img src="../images/tree.png" alt="AltText" title="Title" /></p>

<h2 id="install-qt">Install Qt</h2>

<p>Now we also need Qt. You can download it here: <a href="https://www.qt.io/download">https://www.qt.io/download</a>.
You should install the following components. <br />
<img src="../images/qt.png" alt="AltText" title="Title" /> <br />
You need Desktop to test your apps on the desktop. <br />
You need Android x86 to test yours apps on a simulator. <br />
You need Android ARM64 to test on a 64 bit device and <br />
you need Android ARMv7 to test on a 32 bit device.</p>

<h2 id="download-source-packages">Download Source packages</h2>

<p>-openssl-1.0.2s.tar.gz from <a href="https://www.openssl.org/source/">https://www.openssl.org/source/</a> <br />
-PyQt3D<em>gpl-5.12.tar.gz from <a href="https://www.riverbankcomputing.com/software/pyqt3d/download">https://www.riverbankcomputing.com/software/pyqt3d/download</a> <br />
-PyQt5</em>gpl-5.12.1.tar.gz from <a href="https://www.riverbankcomputing.com/software/pyqt/download5">https://www.riverbankcomputing.com/software/pyqt/download5</a> <br />
-PyQtChart<em>gpl-5.12.tar.gz from <a href="https://www.riverbankcomputing.com/software/pyqtchart/download">https://www.riverbankcomputing.com/software/pyqtchart/download</a> <br />
-PyQtDataVisualization</em>gpl-5.12.tar.gz from <a href="https://www.riverbankcomputing.com/software/pyqtdatavisualization/download">https://www.riverbankcomputing.com/software/pyqtdatavisualization/download</a> <br />
-PyQtPurchasing<em>gpl-5.12.tar.gz from <a href="https://www.riverbankcomputing.com/software/pyqtpurchasing/download">https://www.riverbankcomputing.com/software/pyqtpurchasing/download</a> <br />
-Python-3.7.2.tar.xz from <a href="https://www.python.org/downloads/source/">https://www.python.org/downloads/source/</a> <br />
-QScintilla</em>gpl-2.11.1.tar.gz from <a href="https://www.riverbankcomputing.com/software/qscintilla/download">https://www.riverbankcomputing.com/software/qscintilla/download</a> <br />
-qt-everywhere-src-5.12.2.tar.xz from <a href="http://download.qt.io/official_releases/qt/5.12/5.12.2/single/qt-everywhere-src-5.12.2.tar.xz.mirrorlist">http://download.qt.io/official_releases/qt/5.12/5.12.2/single/qt-everywhere-src-5.12.2.tar.xz.mirrorlist</a> <br />
-sip-4.19.15.tar.gz from <a href="https://www.riverbankcomputing.com/software/sip/download">https://www.riverbankcomputing.com/software/sip/download</a> <br />
-zlib-1.2.11.tar.gz from <a href="https://zlib.net/">https://zlib.net/</a>  </p>

<p>Do not unpack these files!!! <br />
Just download them and copy them to a specific directory.</p>

<h2 id="create-the-build-script">Create the build script</h2>

<p>You should change the paths in the following script to your needs.  </p>

<p><em>Deploy/build.sh</em>  </p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="nb">export</span> <span class="nv">ANDROID_NDK_ROOT</span><span class="o">=</span>/home/art/Android/Sdk/ndk-bundle
<span class="line-number"><span>2</span></span> <span class="nb">export</span> <span class="nv">ANDROID_NDK_PLATFORM</span><span class="o">=</span>android-28
<span class="line-number"><span>3</span></span> <span class="nb">export</span> <span class="nv">ANDROID_SDK_ROOT</span><span class="o">=</span>/home/art/Android/Sdk
<span class="line-number"><span>4</span></span> python3.7 build.py --target android-32 --installed-qt-dir /home/art/Qt/5.12.3 --no-sysroot --verbose --source-dir ./external-sources
</code></pre></div>

<h2 id="create-the-buildpy-script">Create the build.py script</h2>

<p>The build.py I have got from here: <a href="https://pypi.org/project/pyqtdeploy/#files">https://pypi.org/project/pyqtdeploy/#files</a> from the Demo project.
I have just added these lines of code: </p>

<p><em>Deploy/build.py</em> </p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="o">...</span>
<span class="line-number"><span>2</span></span> <span class="n">run</span><span class="p">([</span><span class="s1">&#39;pyqtdeploy-build&#39;</span><span class="p">,</span> <span class="s1">&#39;--target&#39;</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="s1">&#39;--sysroot&#39;</span><span class="p">,</span> <span class="n">sysroot_dir</span><span class="p">,</span> <span class="s1">&#39;--build-dir&#39;</span><span class="p">,</span> <span class="n">build_dir</span><span class="p">,</span> <span class="s1">&#39;demo.pdy&#39;</span><span class="p">])</span>
<span class="line-number"><span>3</span></span> 
<span class="line-number"><span>4</span></span> <span class="c1"># copy the main.qml to a directory where androiddeployqt will find it to add required libraries based on the import statements</span>
<span class="line-number"><span>5</span></span> <span class="n">cp</span> <span class="o">=</span> <span class="s2">&quot;cp &quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;view.qml&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">build_dir</span><span class="p">)</span>
<span class="line-number"><span>6</span></span> <span class="n">run</span><span class="p">([</span><span class="n">cp</span><span class="p">])</span>
<span class="line-number"><span>7</span></span> <span class="c1"># append the ANDROID_PACKAGE to the .pro file</span>
<span class="line-number"><span>8</span></span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">build_dir</span><span class="p">,</span> <span class="s2">&quot;main.pro&quot;</span><span class="p">),</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="line-number"><span>9</span></span>     <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">contains(ANDROID_TARGET_ARCH, armeabi-v7a) {</span><span class="se">\n</span><span class="s2">ANDROID_PACKAGE_SOURCE_DIR = &quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;android&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">}&quot;</span><span class="p">)</span>
<span class="line-number"><span>10</span></span> 
<span class="line-number"><span>11</span></span> <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">build_dir</span><span class="p">)</span>
<span class="line-number"><span>12</span></span> <span class="o">...</span>
</code></pre></div>

<p>It is necessary that the androiddeployqt app will find a QML file in this directory. It scans all needed QML files for import statements to include the needed shared libraries into the APK. <br />
androiddeployqt will be called by pyqtdeploy.  </p>

<p>You can find the complete build.py and all other source files in the github repo: <a href="https://github.com/Artanidos/DevAndroidPythonBook">https://github.com/Artanidos/DevAndroidPythonBook</a>  </p>

<p>With the ANDROID<em>PACKAGE</em>SOURCE_DIR we specify that we have got Android specific files like the <em>AndroidManifest.xml</em> and the icons in this specific folder. <br />
Also an app theme is included there. This theme only has one important thing <em>Theme.DeviceDefault.Light.NoActionBar</em>.
This is needed to make the splash screen look not so ugly. <br />
This is the default splash screen. With this little change the screen is just white.  </p>

<p><img src="../images/galery.png" alt="AltText" title="Title" /></p>

<h2 id="create-the-resource-file">Create the resource file</h2>

<p>The resource file will contain our QML file as a python resource. <br />
To build the resource run the following.  </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> pyrcc5 main.qrc -o lib/main_rc.py
</code></pre></div>

<p>This is needed to find the QML later on the device. 
After these changes we have to change the main.py as follows:  </p>

<p><em>Deploy/main.py</em>  </p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="line-number"><span>2</span></span> <span class="kn">import</span> <span class="nn">lib.main_rc</span>
<span class="line-number"><span>3</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QGuiApplication</span>
<span class="line-number"><span>4</span></span> <span class="kn">from</span> <span class="nn">PyQt5.QtQml</span> <span class="kn">import</span> <span class="n">QQmlApplicationEngine</span>
<span class="line-number"><span>5</span></span> 
<span class="line-number"><span>6</span></span> 
<span class="line-number"><span>7</span></span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="line-number"><span>8</span></span>     <span class="n">app</span> <span class="o">=</span> <span class="n">QGuiApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="line-number"><span>9</span></span>     <span class="n">engine</span> <span class="o">=</span> <span class="n">QQmlApplicationEngine</span><span class="p">(</span><span class="s2">&quot;:/view.qml&quot;</span><span class="p">)</span>
<span class="line-number"><span>10</span></span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">engine</span><span class="o">.</span><span class="n">rootObjects</span><span class="p">():</span>
<span class="line-number"><span>11</span></span>         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="line-number"><span>12</span></span>     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="k">exec</span><span class="p">())</span>
</code></pre></div>

<p>With <code>import lib.main_r
</code> we add the resource file. <br />
And with the double point in <strong>:</strong>/view.qml we will tell Qt to load this file from a resource.</p>

<h2 id="create-a-project-file">Create a project file</h2>

<p>The project file has the name demo.pdy and is needed for pyqtdeploy to be able to freeze all necessary packages.  </p>

<p><em>Deploy/demo.pdy</em></p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt;</span>
<span class="line-number"><span>2</span></span> <span class="nt">&lt;Project</span> <span class="na">usingdefaultlocations=</span><span class="s">&quot;1&quot;</span> <span class="na">version=</span><span class="s">&quot;7&quot;</span><span class="nt">&gt;</span>
<span class="line-number"><span>3</span></span> <span class="nt">&lt;Python</span> <span class="na">major=</span><span class="s">&quot;3&quot;</span> <span class="na">minor=</span><span class="s">&quot;7&quot;</span> <span class="na">patch=</span><span class="s">&quot;2&quot;</span> <span class="na">platformpython=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>4</span></span> <span class="nt">&lt;Application</span> <span class="na">entrypoint=</span><span class="s">&quot;&quot;</span> <span class="na">isbundle=</span><span class="s">&quot;0&quot;</span> <span class="na">isconsole=</span><span class="s">&quot;0&quot;</span> <span class="na">ispyqt5=</span><span class="s">&quot;1&quot;</span> <span class="na">name=</span><span class="s">&quot;&quot;</span> <span class="na">script=</span><span class="s">&quot;main.py&quot;</span> <span class="na">syspath=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
<span class="line-number"><span>5</span></span> <span class="nt">&lt;Package</span> <span class="na">name=</span><span class="s">&quot;lib&quot;</span><span class="nt">&gt;</span>
<span class="line-number"><span>6</span></span> <span class="nt">&lt;PackageContent</span> <span class="na">included=</span><span class="s">&quot;1&quot;</span> <span class="na">isdirectory=</span><span class="s">&quot;0&quot;</span> <span class="na">name=</span><span class="s">&quot;__init__.py&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>7</span></span> <span class="nt">&lt;PackageContent</span> <span class="na">included=</span><span class="s">&quot;1&quot;</span> <span class="na">isdirectory=</span><span class="s">&quot;0&quot;</span> <span class="na">name=</span><span class="s">&quot;main_rc.py&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>8</span></span> <span class="nt">&lt;Exclude</span> <span class="na">name=</span><span class="s">&quot;*.py&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>9</span></span> <span class="nt">&lt;Exclude</span> <span class="na">name=</span><span class="s">&quot;*.qml&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>10</span></span> <span class="nt">&lt;Exclude</span> <span class="na">name=</span><span class="s">&quot;*.sh&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>11</span></span> <span class="nt">&lt;Exclude</span> <span class="na">name=</span><span class="s">&quot;*.pdy&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>12</span></span> <span class="nt">&lt;Exclude</span> <span class="na">name=</span><span class="s">&quot;*.json&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>13</span></span> <span class="nt">&lt;Exclude</span> <span class="na">name=</span><span class="s">&quot;*.qrc&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>14</span></span> <span class="nt">&lt;Exclude</span> <span class="na">name=</span><span class="s">&quot;build-android-32&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>15</span></span> <span class="nt">&lt;Exclude</span> <span class="na">name=</span><span class="s">&quot;sysroot-android-32&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>16</span></span> <span class="nt">&lt;/Package&gt;</span>
<span class="line-number"><span>17</span></span> <span class="nt">&lt;/Application&gt;</span>
<span class="line-number"><span>18</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;QtWidgets&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>19</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;QtNetwork&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>20</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;QtAndroidExtras&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>21</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;QtSvg&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>22</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;QtQuick&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>23</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;QtQml&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>24</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;Qt&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>25</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;QtQuickWidgets&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>26</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;QtSensors&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>27</span></span> <span class="nt">&lt;PyQtModule</span> <span class="na">name=</span><span class="s">&quot;QtBluetooth&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>28</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;http.server&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>29</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;http&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>30</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;ssl&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>31</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;sysconfig&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>32</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;zlib&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>33</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;importlib.resources&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>34</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;os&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>35</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;marshal&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>36</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;imp&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>37</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;logging&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>38</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;logging.config&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>39</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;logging.handlers&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>40</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;contextlib&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>41</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;urllib&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>42</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;urllib.request&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>43</span></span> <span class="nt">&lt;StdlibModule</span> <span class="na">name=</span><span class="s">&quot;traceback&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>44</span></span> <span class="nt">&lt;ExternalLib</span> <span class="na">defines=</span><span class="s">&quot;&quot;</span> <span class="na">includepath=</span><span class="s">&quot;&quot;</span> <span class="na">libs=</span><span class="s">&quot;-lz&quot;</span> <span class="na">name=</span><span class="s">&quot;zlib&quot;</span> <span class="na">target=</span><span class="s">&quot;android&quot;</span> <span class="nt">/&gt;</span>
<span class="line-number"><span>45</span></span> <span class="nt">&lt;/Project&gt;</span>
</code></pre></div>

<p>One important thing here is the fact that we need a directory for all other python files to be included into the APK. We are using <em>lib</em> here.  Inside this directory should be an empty file named <em>__init__.py</em>. <br />
Then all needed Qt packages are defined here. (We don't need all of them but maybe later). <br />
And also all needed standard python libraries are listed here.
This file can be produced using this command in the terminal:  </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> pyqtdeploy
</code></pre></div>

<h2 id="create-sysrootjson">Create sysroot.json</h2>

<p>This file hold all properties necessary to create a sysroot directory where some tools will be compiled. </p>

<p><em>Deploy/sysroot.json</em> </p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="p">{</span>
<span class="line-number"><span>2</span></span>     <span class="nt">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;The sysroot for the DynPy application.&quot;</span><span class="p">,</span>
<span class="line-number"><span>3</span></span> 
<span class="line-number"><span>4</span></span>     <span class="nt">&quot;android|macos|win#openssl&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="line-number"><span>5</span></span>         <span class="nt">&quot;android#source&quot;</span><span class="p">:</span>   <span class="s2">&quot;openssl-1.0.2s.tar.gz&quot;</span><span class="p">,</span>
<span class="line-number"><span>6</span></span>         <span class="nt">&quot;macos|win#source&quot;</span><span class="p">:</span> <span class="s2">&quot;openssl-1.1.0j.tar.gz&quot;</span><span class="p">,</span>
<span class="line-number"><span>7</span></span>         <span class="nt">&quot;win#no_asm&quot;</span><span class="p">:</span>       <span class="kc">true</span>
<span class="line-number"><span>8</span></span>     <span class="p">},</span>
<span class="line-number"><span>9</span></span> 
<span class="line-number"><span>10</span></span>     <span class="nt">&quot;linux|macos|win#zlib&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="line-number"><span>11</span></span>         <span class="nt">&quot;source&quot;</span><span class="p">:</span>               <span class="s2">&quot;zlib-1.2.11.tar.gz&quot;</span><span class="p">,</span>
<span class="line-number"><span>12</span></span>         <span class="nt">&quot;static_msvc_runtime&quot;</span><span class="p">:</span>  <span class="kc">true</span>
<span class="line-number"><span>13</span></span>     <span class="p">},</span>
<span class="line-number"><span>14</span></span> 
<span class="line-number"><span>15</span></span>     <span class="nt">&quot;qt5&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="line-number"><span>16</span></span>         <span class="nt">&quot;android-32#qt_dir&quot;</span><span class="p">:</span>        <span class="s2">&quot;android_armv7&quot;</span><span class="p">,</span>
<span class="line-number"><span>17</span></span>         <span class="nt">&quot;android-64#qt_dir&quot;</span><span class="p">:</span>        <span class="s2">&quot;android_arm64_v8a&quot;</span><span class="p">,</span>
<span class="line-number"><span>18</span></span> 
<span class="line-number"><span>19</span></span>         <span class="nt">&quot;linux|macos|win#source&quot;</span><span class="p">:</span>   <span class="s2">&quot;qt-everywhere-src-5.12.2.tar.xz&quot;</span><span class="p">,</span>
<span class="line-number"><span>20</span></span>         <span class="nt">&quot;edition&quot;</span><span class="p">:</span>                  <span class="s2">&quot;opensource&quot;</span><span class="p">,</span>
<span class="line-number"><span>21</span></span> 
<span class="line-number"><span>22</span></span>         <span class="nt">&quot;android|linux#ssl&quot;</span><span class="p">:</span>        <span class="s2">&quot;openssl-runtime&quot;</span><span class="p">,</span>
<span class="line-number"><span>23</span></span>         <span class="nt">&quot;ios#ssl&quot;</span><span class="p">:</span>                  <span class="s2">&quot;securetransport&quot;</span><span class="p">,</span>
<span class="line-number"><span>24</span></span>         <span class="nt">&quot;macos|win#ssl&quot;</span><span class="p">:</span>            <span class="s2">&quot;openssl-linked&quot;</span><span class="p">,</span>
<span class="line-number"><span>25</span></span> 
<span class="line-number"><span>26</span></span>         <span class="nt">&quot;configure_options&quot;</span><span class="p">:</span>        <span class="p">[</span>
<span class="line-number"><span>27</span></span>                 <span class="s2">&quot;-opengl&quot;</span><span class="p">,</span> <span class="s2">&quot;desktop&quot;</span><span class="p">,</span> <span class="s2">&quot;-no-dbus&quot;</span><span class="p">,</span> <span class="s2">&quot;-qt-pcre&quot;</span>
<span class="line-number"><span>28</span></span>         <span class="p">],</span>
<span class="line-number"><span>29</span></span>         <span class="nt">&quot;skip&quot;</span><span class="p">:</span>                     <span class="p">[</span>
<span class="line-number"><span>30</span></span>                 <span class="s2">&quot;qtactiveqt&quot;</span><span class="p">,</span> <span class="s2">&quot;qtconnectivity&quot;</span><span class="p">,</span> <span class="s2">&quot;qtdoc&quot;</span><span class="p">,</span> <span class="s2">&quot;qtgamepad&quot;</span><span class="p">,</span>
<span class="line-number"><span>31</span></span>                 <span class="s2">&quot;qtlocation&quot;</span><span class="p">,</span> <span class="s2">&quot;qtmultimedia&quot;</span><span class="p">,</span> <span class="s2">&quot;qtnetworkauth&quot;</span><span class="p">,</span>
<span class="line-number"><span>32</span></span>                 <span class="s2">&quot;qtremoteobjects&quot;</span><span class="p">,</span>
<span class="line-number"><span>33</span></span>                 <span class="s2">&quot;qtscript&quot;</span><span class="p">,</span> <span class="s2">&quot;qtscxml&quot;</span><span class="p">,</span> <span class="s2">&quot;qtserialbus&quot;</span><span class="p">,</span>
<span class="line-number"><span>34</span></span>                 <span class="s2">&quot;qtserialport&quot;</span><span class="p">,</span> <span class="s2">&quot;qtspeech&quot;</span><span class="p">,</span> <span class="s2">&quot;qttools&quot;</span><span class="p">,</span>
<span class="line-number"><span>35</span></span>                 <span class="s2">&quot;qttranslations&quot;</span><span class="p">,</span> <span class="s2">&quot;qtwayland&quot;</span><span class="p">,</span> <span class="s2">&quot;qtwebchannel&quot;</span><span class="p">,</span> <span class="s2">&quot;qtwebengine&quot;</span><span class="p">,</span>
<span class="line-number"><span>36</span></span>                 <span class="s2">&quot;qtwebsockets&quot;</span><span class="p">,</span> <span class="s2">&quot;qtwebview&quot;</span><span class="p">,</span> <span class="s2">&quot;qtxmlpatterns&quot;</span>
<span class="line-number"><span>37</span></span>         <span class="p">],</span>
<span class="line-number"><span>38</span></span> 
<span class="line-number"><span>39</span></span>         <span class="nt">&quot;static_msvc_runtime&quot;</span><span class="p">:</span>      <span class="kc">true</span>
<span class="line-number"><span>40</span></span>     <span class="p">},</span>
<span class="line-number"><span>41</span></span> 
<span class="line-number"><span>42</span></span>     <span class="nt">&quot;python&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="line-number"><span>43</span></span>         <span class="nt">&quot;build_host_from_source&quot;</span><span class="p">:</span>   <span class="kc">false</span><span class="p">,</span>
<span class="line-number"><span>44</span></span>         <span class="nt">&quot;build_target_from_source&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="line-number"><span>45</span></span>         <span class="nt">&quot;source&quot;</span><span class="p">:</span>                   <span class="s2">&quot;Python-3.7.2.tar.xz&quot;</span>
<span class="line-number"><span>46</span></span>     <span class="p">},</span>
<span class="line-number"><span>47</span></span> 
<span class="line-number"><span>48</span></span>     <span class="nt">&quot;sip&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="line-number"><span>49</span></span>         <span class="nt">&quot;module_name&quot;</span><span class="p">:</span>  <span class="s2">&quot;PyQt5.sip&quot;</span><span class="p">,</span>
<span class="line-number"><span>50</span></span>         <span class="nt">&quot;source&quot;</span><span class="p">:</span>       <span class="s2">&quot;sip-4.19.15.tar.gz&quot;</span>
<span class="line-number"><span>51</span></span>     <span class="p">},</span>
<span class="line-number"><span>52</span></span> 
<span class="line-number"><span>53</span></span>     <span class="nt">&quot;pyqt5&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="line-number"><span>54</span></span>         <span class="nt">&quot;android#disabled_features&quot;</span><span class="p">:</span>    <span class="p">[</span>
<span class="line-number"><span>55</span></span>                 <span class="s2">&quot;PyQt_Desktop_OpenGL&quot;</span><span class="p">,</span> <span class="s2">&quot;PyQt_Printer&quot;</span><span class="p">,</span> <span class="s2">&quot;PyQt_PrintDialog&quot;</span><span class="p">,</span>
<span class="line-number"><span>56</span></span>                 <span class="s2">&quot;PyQt_PrintPreviewDialog&quot;</span><span class="p">,</span> <span class="s2">&quot;PyQt_PrintPreviewWidget&quot;</span>
<span class="line-number"><span>57</span></span>         <span class="p">],</span>
<span class="line-number"><span>58</span></span>         <span class="nt">&quot;android#modules&quot;</span><span class="p">:</span>              <span class="p">[</span>
<span class="line-number"><span>59</span></span>                 <span class="s2">&quot;QtQuick&quot;</span><span class="p">,</span> <span class="s2">&quot;QtCore&quot;</span><span class="p">,</span> <span class="s2">&quot;QtGui&quot;</span><span class="p">,</span> <span class="s2">&quot;QtNetwork&quot;</span><span class="p">,</span> <span class="s2">&quot;QtPrintSupport&quot;</span><span class="p">,</span> <span class="s2">&quot;QtWidgets&quot;</span><span class="p">,</span>
<span class="line-number"><span>60</span></span>                 <span class="s2">&quot;QtAndroidExtras&quot;</span><span class="p">,</span> <span class="s2">&quot;QtQuickWidgets&quot;</span><span class="p">,</span> <span class="s2">&quot;QtSvg&quot;</span><span class="p">,</span> <span class="s2">&quot;QtBluetooth&quot;</span><span class="p">,</span> <span class="s2">&quot;QtNetwork&quot;</span><span class="p">,</span> <span class="s2">&quot;QtSensors&quot;</span><span class="p">,</span> 
<span class="line-number"><span>61</span></span>                 <span class="s2">&quot;QtQml&quot;</span>
<span class="line-number"><span>62</span></span>         <span class="p">],</span>
<span class="line-number"><span>63</span></span> 
<span class="line-number"><span>64</span></span>         <span class="nt">&quot;source&quot;</span><span class="p">:</span>                       <span class="s2">&quot;PyQt5_*-5.12.1.tar.gz&quot;</span>
<span class="line-number"><span>65</span></span>     <span class="p">}</span>
<span class="line-number"><span>66</span></span> <span class="p">}</span>
</code></pre></div>

<h2 id="build-the-apk">Build the APK</h2>

<p>If all went well we are now able to build the APK and deploy it to a device.
Therefore we run <code>./build.s
</code> in the terminal. Make sure that <em>build.sh</em> is executable.
This first will create a sysroot directory with tools and libraries. If you are going to build the APK a second time you can skip building the sysroot with this option in the <em>build.sh</em>: </p>

<pre><code>--no-sysroot
</code></pre>

<h2 id="install-apk-to-device">Install APK to device</h2>

<p>When you have successfully build the APK you are now able to install it to your device. <br />
First of all make sure the developer-mode is switched on on your device. If not you have to switch it on first. <br />
Open your device settings app. Look for "About you phone" and search for the "Build Number". Then you have to tap on it seven times. <br />
You should get a message that the developer options are now turned on. 
Connect your device to your computer using a USB cable. <br />
Now open the developer option in the settings app and look for USB-Configuration. Normally it is set to "Just load". Change it now to media transfer protocol (MTP). <br />
Then look for USB-Debugging and switch it to on. <br />
This done you are now able to find your device with the adb command:  </p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="gp">user@machine:/path$</span> adb devices
<span class="line-number"><span>2</span></span> <span class="go">List of devices attached</span>
<span class="line-number"><span>3</span></span> <span class="go">* daemon not running; starting now at tcp:5037</span>
<span class="line-number"><span>4</span></span> <span class="go">* daemon started successfully</span>
<span class="line-number"><span>5</span></span> <span class="go">5WH6R19329010194    device</span>
</code></pre></div>

<p>If your device is listed copy the string to the left and paste it into the terminal:  </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> adb -s 5WH6R19329010194 install /home/art/Sourcecode/Python/Book/Deploy/build-android-32/dynpy/build/outputs/apk/debug/demo-debug.apk
</code></pre></div>

<p>Also copy the APK path which will be displayed after the build process has finished.</p>

<p>I have put the whole command into the <em>deploy.sh</em> file to use it later.</p>

<h2 id="summary">Summary</h2>

<p>Hopefully we have deployed the demo app to our device. 
To find out how to build and deploy to Android took me several days. <br />
If you are running into trouble here don't hesitate to contact me. <br />
Maybe I can help you out and publish our experience into the next version of this book so that other people are not running into trouble.</p>
<h1 id="deploying-to-linux">Deploying to Linux</h1>

<p>On Linux, Windows and MacOS I prefer to use another tool called <strong>PyInstaller</strong> because it resolves all dependencies automatically. <br />
To create a setup program I prefer to use the <strong>QtInstallerFramework</strong> delivered with Qt, because it is also cross platform and free to use.</p>

<h2 id="install-pyinstaller">Install PyInstaller</h2>

<p>You can download PyInstaller using pip.</p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> pip3 install pyinstaller
</code></pre></div>

<p>PyInstaller bundles a Python application and all its dependencies into a single package. The user can run the packaged app without installing a Python interpreter or any modules.</p>

<h2 id="install-qtinstallerframework">Install QtInstallerFramework</h2>

<p>Now we also need Qt. You can download it here: <a href="https://www.qt.io/download">https://www.qt.io/download</a>.
You should install the following components. <br />
<img src="../images/installer.png" alt="installer" title="installer" /> <br />
If there is no option for version 3.1 (Windows) then 3.0 will do also. </p>

<h2 id="build-executable">Build Executable</h2>

<p>To create a package just run pyinstaller with the main python module as argument.</p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> pyinstaller main.py
</code></pre></div>

<h2 id="test-executable">Test Executable</h2>

<p>You can then test the compiled application running:</p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> dist/main/main
</code></pre></div>

<p>Theoretically you can now zip all files inside the dist/main directory, but I prefer to build a setup program which you may upload as a single file and therefore we use the QtInstallerFramework now.</p>

<h2 id="create-setup-package">Create Setup Package</h2>

<p>Therefor we first create a folder named config. <br />
Inside the config folder we now create a file named <em>config.xml</em>.  </p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="line-number"><span>2</span></span>   <span class="nt">&lt;Installer&gt;</span>
<span class="line-number"><span>3</span></span>       <span class="nt">&lt;Name&gt;</span>DemoApplication<span class="nt">&lt;/Name&gt;</span>
<span class="line-number"><span>4</span></span>       <span class="nt">&lt;Version&gt;</span>1.0.0<span class="nt">&lt;/Version&gt;</span>
<span class="line-number"><span>5</span></span>       <span class="nt">&lt;Title&gt;</span>DemoApplication<span class="nt">&lt;/Title&gt;</span>
<span class="line-number"><span>6</span></span>       <span class="nt">&lt;Publisher&gt;</span>Publisher<span class="nt">&lt;/Publisher&gt;</span>
<span class="line-number"><span>7</span></span>       <span class="nt">&lt;StartMenuDir&gt;&lt;/StartMenuDir&gt;</span>
<span class="line-number"><span>8</span></span>       <span class="nt">&lt;TargetDir&gt;</span>@HomeDir@/DemoApplication<span class="nt">&lt;/TargetDir&gt;</span>
<span class="line-number"><span>9</span></span>       <span class="nt">&lt;Translations&gt;</span>
<span class="line-number"><span>10</span></span>         <span class="nt">&lt;Translation&gt;</span>en.qm<span class="nt">&lt;/Translation&gt;</span>
<span class="line-number"><span>11</span></span>     <span class="nt">&lt;/Translations&gt;</span>
<span class="line-number"><span>12</span></span>   <span class="nt">&lt;/Installer&gt;</span>
</code></pre></div>

<p>Fill in the following fields as follows:  </p>

<table>
<thead>
<tr>
  <th>Field</th>
  <th>Value</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Name</td>
  <td>Name of the application</td>
</tr>
<tr>
  <td>Version</td>
  <td>Version of the application</td>
</tr>
<tr>
  <td>Title</td>
  <td>Name of the application</td>
</tr>
<tr>
  <td>Publisher</td>
  <td>Your name / your company name</td>
</tr>
<tr>
  <td>TargetDir</td>
  <td>Default install location</td>
</tr>
<tr>
  <td>Translation</td>
  <td>Langage code of you application</td>
</tr>
</tbody>
</table>

<p>If you do not specify a language then Qt is taking the language of the operation system which is not always the best choice. In my case the OS is set to German but all of my application are written in English language.</p>

<p>Now we create a folder named <em>packages</em> and inside of this folder another folder with the name <em>com.vendor.product</em>. Inside of this directory we create a folder named <em>data</em> where we will copy all the binaries later and a folder named <em>meta</em>. Inside the meta folder we are creating a new file named <em>package.xml</em> with the following content:  </p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="line-number"><span>2</span></span>   <span class="nt">&lt;Package&gt;</span>
<span class="line-number"><span>3</span></span>       <span class="nt">&lt;DisplayName&gt;</span>DemoApplication<span class="nt">&lt;/DisplayName&gt;</span>
<span class="line-number"><span>4</span></span>       <span class="nt">&lt;Description&gt;</span>Install this application.<span class="nt">&lt;/Description&gt;</span>
<span class="line-number"><span>5</span></span>       <span class="nt">&lt;Version&gt;</span>0.1.0-1<span class="nt">&lt;/Version&gt;</span>
<span class="line-number"><span>6</span></span>       <span class="nt">&lt;ReleaseDate&gt;</span>2019-07-15<span class="nt">&lt;/ReleaseDate&gt;</span>
<span class="line-number"><span>7</span></span>       <span class="nt">&lt;Default&gt;</span>true<span class="nt">&lt;/Default&gt;</span>
<span class="line-number"><span>8</span></span>   <span class="nt">&lt;/Package&gt;</span>
</code></pre></div>

<p>Now we create a folder named <em>bin</em> inside of the <em>data</em> folder and then we copy all files from dist/main into this folder.</p>

<div class="codehilite"><pre><span></span><code><span class="line-number"><span>1</span></span> <span class="gp">user@machine:/path$</span> mkdir packages/com.vendor.product/data/bin
<span class="line-number"><span>2</span></span> <span class="gp">user@machine:/path$</span> cp -r dist/main/* packages/com.vendor.product/data/bin
</code></pre></div>

<p>Now its time to build the setup program. There we will run the following command:  </p>

<div class="codehilite"><pre><span></span><code><span class="gp">user@machine:/path$</span> binarycreator -f -c config/config.xml -p packages DemoApplication-Linux-1.0.0.Setup
</code></pre></div>

<p>This command will create the file DemoApplication-Linux-1.0.0.Setup which can be shipped to customers. <br />
If you do not have a path to binarycreator you can find it under <em>Qt/Tools/QtInstallerFramework/3.1/bin</em></p>

<p>You can start the setup with just a double-click. <br />
<img src="../images/setup.png" alt="setup" title="setup" /></p>
<h1 id="afterwords">Afterwords</h1>

<p>I am happy that you have read so far. 
I hope this book could help you to learn some more possibilities as a software developer. 
I wish you good luck on your way. 
If you like this book then I would appreciate when you could write a small review on Amazon to help other people to also find this book.</p>

<h1 id="about-the-author">About The Author</h1>

<p>Olaf Japp, born 1963 in Hamburg, Germany has been a software developer for over 30 years now. He started with C, learned Assembler to speed up C programs and after trying out most popular programming languages like Java, C# and Objective-C he came back to C/C++ and started to develop desktop appĺications using Qt5 in 2016.
Qt5 was the ideal platform for him to express his skills he has learned studying Human Computer Interaction Design in 2013. After a first try to use Python to develop plug-ins for his programs he needed another two years to really get to know Python. Today he enjoys the simplicity of this language to write apps in a very short time compared to C++.
Olaf has worked for several top 500 companies like Dupont, Dresdner Bank, Commerzbank and Zürcher Kantonalbank to name a few.
After his burnout and a near death experience he decided to quit working for profit. 
Since 2016 he is writing open source software like the AnimationMaker, the FlatSiteBuilder and the EbookCreator.
He also has written a book about his life and Tantra.
Since 2016 he is living in his mobile home in the middle of Berlin and he is also playing percussion on the streets.
To write code he is going to a public library.
That's an easy living. </p>

</body>
</html>